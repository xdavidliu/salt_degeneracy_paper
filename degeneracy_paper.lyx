#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass revtex4-1
\begin_preamble
\renewcommand\vec{\mathbf}
\renewcommand{\Im}{\mathrm{Im}}
\renewcommand{\Re}{\mathrm{Re}}
\newcommand{\Dt}{D_\mathrm{t}}
\end_preamble
\options aps,article,twocolumn,superscriptaddress
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 2
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Symmetry, stability, and computation of degenerate lasing modes
\end_layout

\begin_layout Author
David
\begin_inset space ~
\end_inset

Liu
\end_layout

\begin_layout Affiliation
Department of Mathematics, Massachusetts Institute of Technology, Cambridge,
 Massachusetts 02139, USA
\end_layout

\begin_layout Affiliation
Department of Physics, Massachusetts Institute of Technology, Cambridge,
 Massachusetts 02139, USA
\end_layout

\begin_layout Author
Bo
\begin_inset space ~
\end_inset

Zhen
\end_layout

\begin_layout Affiliation
Department of Physics, Massachusetts Institute of Technology, Cambridge,
 Massachusetts 02139, USA
\end_layout

\begin_layout Author
Li
\begin_inset space ~
\end_inset

Ge
\end_layout

\begin_layout Affiliation
Department of Engineering Science and Physics, College of Staten Island,
 and The Graduate Center, CUNY, Staten Island, New York 10314, USA
\end_layout

\begin_layout Author
Felipe
\begin_inset space ~
\end_inset

Hernandez
\end_layout

\begin_layout Affiliation
Department of Mathematics, Massachusetts Institute of Technology, Cambridge,
 Massachusetts 02139, USA
\end_layout

\begin_layout Author
Adi
\begin_inset space ~
\end_inset

Pick
\end_layout

\begin_layout Affiliation
Department of Physics, Harvard University, Cambridge, Massachusetts 02138,
 USA
\end_layout

\begin_layout Author
Stephan
\begin_inset space ~
\end_inset

Burkhardt
\end_layout

\begin_layout Affiliation
Institute for Theoretical Physics, Vienna University of Technology, Vienna,
 Austria
\end_layout

\begin_layout Author
Matthias
\begin_inset space ~
\end_inset

Liertzer
\end_layout

\begin_layout Affiliation
Institute for Theoretical Physics, Vienna University of Technology, Vienna,
 Austria
\end_layout

\begin_layout Author
Stefan
\begin_inset space ~
\end_inset

Rotter
\end_layout

\begin_layout Affiliation
Institute for Theoretical Physics, Vienna University of Technology, Vienna,
 Austria
\end_layout

\begin_layout Author
Steven
\begin_inset space ~
\end_inset

G.
\begin_inset space ~
\end_inset

Johnson
\end_layout

\begin_layout Affiliation
Department of Mathematics, Massachusetts Institute of Technology, Cambridge,
 Massachusetts 02139, USA
\end_layout

\begin_layout Affiliation
Department of Physics, Massachusetts Institute of Technology, Cambridge,
 Massachusetts 02139, USA
\end_layout

\begin_layout Abstract
We present a general method to obtain the stable lasing solutions for the
 steady-state 
\emph on
ab-initio
\emph default
 lasing theory (SALT) for the case of a degenerate symmetric laser in two
 dimensions (2d).
 We find that under most regimes (with one pathological exception), the
 stable solutions are clockwise and counterclockwise circulating modes,
 generalizing previously known results of ring lasers to all 2d rotational
 symmetry groups.
 Our method uses a combination of semi-analytical solutions close to lasing
 threshold and numerical solvers to track the lasing modes far above threshold.
 Near threshold, we find closed-form expressions for both circulating modes
 and other types of lasing solutions as well as for their linearized Maxwellâ€“Blo
ch eigenvalues, providing a simple way to determine their stability without
 having to do a full numerical calculation.
 Above threshold, we show that a key feature of the circulating mode is
 its 
\begin_inset Quotes eld
\end_inset

chiral
\begin_inset Quotes erd
\end_inset

 intensity pattern, which arises from spontaneous symmetry-breaking of mirror
 symmetry, and whose symmetry group requires that the degeneracy persist
 even when nonlinear effects become important.
 Finally, we introduce a numerical technique to solve the degenerate SALT
 equations far above threshold even when spatial discretization artificially
 breaks the degeneracy.
\end_layout

\begin_layout Section
Introduction
\begin_inset CommandInset label
LatexCommand label
name "sec:Introduction"

\end_inset


\end_layout

\begin_layout Standard
Many lasers are formed from high-symmetry microcavity geometries that have
 degenerate resonant modes, most famously ring and disc resonators in which
 the clockwise and counterclockwise circulating modes are degenerate (having
 the same complex resonant frequency).
 In a linear system, any superposition of these solutions also satisfies
 Maxwell's equations, but above-threshold lasers have nonlinear gain that
 allows only certain superpositions; it is well known that the only stable
 lasing solutions of a ring are the circulating solutions 
\begin_inset Formula $\mathbf{E}\sim e^{im\phi}$
\end_inset

, as opposed to the standing-wave modes 
\begin_inset Formula $\mathbf{E}\sim\sin m\phi$
\end_inset

, 
\begin_inset Formula $\cos m\phi$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-cao_review,modeswitching2014,ref-matsko,ref-pnas_whispering"

\end_inset

.
 However, more recent microcavities often have other 2d symmetry groups
 supporting degeneracies 
\begin_inset CommandInset citation
LatexCommand cite
key "inui_group"

\end_inset

, such as the 6-fold symmetry that commonly occurs in photonic-crystal resonator
s 
\begin_inset CommandInset citation
LatexCommand cite
key "englund"

\end_inset

, an example of a 3d structure with a 2d symmetry (as seen in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:overview"

\end_inset

), or more generally the 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry group (
\begin_inset Formula $n$
\end_inset

-fold rotations and 
\begin_inset Formula $n$
\end_inset

 mirror planes) for 
\begin_inset Formula $n>2$
\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "inui_group"

\end_inset

, and much less is known about the lasing solutions in such cases.
 Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:overview"

\end_inset

 gives examples of degenerate lasing modes in 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 geometries.
 Previous work 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

 showed how the steady-state degenerate solutions of SALT (steady-state
 ab-initio lasing theory 
\begin_inset CommandInset citation
LatexCommand cite
key "tureci_self-consistent_2006,tureci_strong_2008,tureci_ab_2009,ge_quantitative_2008,ge_steady-state_2010"

\end_inset

) could be found from an educated guess of a superposition of the threshold
 degenerate modes, and how their stability could be computed 
\emph on
numerically
\emph default
.
 In this work, we show rigorously using degenerate perturbation theory on
 the SALT equations that the circulating modes used in Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

, along with standing-wave modes that are linear combinations of the clockwise
 and counterclockwise circulating modes, are the 
\emph on
only 
\emph default
solutions to SALT in the 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 degenerate case.
 We complement those results with semi-analytical 
\emph on
closed-form
\emph default
 expressions for the stability eigenvalues of the Maxwell--Bloch equations
 linearized about these lasing solutions (Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Threshold-perturbation-theory"

\end_inset

).
 We empirically find that the only stable solutions right above threshold
 (with one isolated exception that is unattainable under normal circumstances)
 are the circulating ones.
 These analytical solutions then give us a starting point for a 
\emph on
numerical
\emph default
 method to compute the degenerate solutions far above threshold, extending
 our earlier work on computational methods for non-degenerate SALT
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "direct_salt"

\end_inset

.
 Our numerical method, in turn, relies on a new semi-analytical technique
 (Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Forcing-the-degeneracy"

\end_inset

) to address problems created by numerical symmetry breaking (e.g.
 by a low-symmetry computational grid) that would otherwise spoil the nonlinear
 SALT solutions.
\end_layout

\begin_layout Standard
In Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

, a full linear-stability analysis (Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Stability-analysis summary"

\end_inset

) was applied numerically to the Maxwell--Bloch equations of lasing in order
 to check whether the steady state was stable, and stability of the solution
 was also analyzed when the degeneracy was broken by a perturbation.
 This generalized many earlier works on ring-laser solutions and perturbations
 thereof
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-risken_instability,ref-bidirectional,ref-MBring,ref-breaking_cylindrical_symmetry,ref-tamm"

\end_inset

.
 It reproduced the stability of the circulating solution near threshold,
 and found that far above the lasing threshold (where nonlinearities are
 strong) the circulating solution may become unstable (replaced by an oscillatin
g limit-cycle solution).
 Conversely, they found that slightly breaking the symmetry caused the (now
 nearly degenerate) solution to become unstable (e.g.
 oscillating between clockwise and counterclockwise modes) in the vicinity
 of the threshold, but that a stable solution re-appears further above threshold
 by means of cooperative frequency locking
\begin_inset CommandInset citation
LatexCommand cite
key "ref-lugiato-josa,ref-tamm"

\end_inset

.
 The present paper complements those results in two ways.
 First, near threshold, we are able to both 
\emph on
solve for
\emph default
 the steady-state lasing modes (Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Threshold-perturbation-theory"

\end_inset

) and evaluate their stability (Appendix
\begin_inset space ~
\end_inset

B) 
\emph on
analytically
\emph default
, by perturbation theory in the basis of the degenerate linear solutions
 at lasing threshold, and we generalize the notion of a circulating laser
 mode to other symmetry groups and establish its stability near threshold.
 (Even the degeneracy itself is somewhat unusual above threshold, because
 the nonlinear gain spontaneously breaks some of the symmetry in noncircular
 (
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 with 
\begin_inset Formula $n\neq\infty$
\end_inset

) geometries, leaving one with a 
\begin_inset Quotes eld
\end_inset

chiral
\begin_inset Quotes erd
\end_inset

 degeneracy as discussed in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Stability-analysis summary"

\end_inset

, Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "dichroism"

\end_inset

, and Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix allowed lasing modes"

\end_inset

.) Second, we develop a numerical solution technique for 
\emph on
far above
\emph default
 threshold in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Forcing-the-degeneracy"

\end_inset

, generalizing earlier SALT methods, where a numerical nonlinear solver
 is the only option; in this regime, our focus is on finding a degenerate
 lasing mode in SALT (if one exists), and we defer to the results of Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

 for checking its stability after a solution far above threshold is found.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename overview_fig/overview.pdf
	scale 110

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Degenerate pairs of standing-wave modes in a laser.
 For this uniform dielectric disk (top), which has 
\begin_inset Formula $C_{\infty\mathrm{v}}$
\end_inset

 symmetry, the two eigenfunctions (of which only the real part is shown)
 are proportional to 
\begin_inset Formula $\cos(\ell\phi)$
\end_inset

 and 
\begin_inset Formula $\sin(\ell\phi)$
\end_inset

 (here, 
\begin_inset Formula $\ell=9$
\end_inset

).
 For a homogeneous dielectric square (
\begin_inset Formula $\varepsilon=5$
\end_inset

 inside a square of length 1), the eigenfunctions are 
\begin_inset Formula $\frac{\pi}{2}$
\end_inset

 rotations of one another (here, the order of the irreducible representation
 is 
\begin_inset Formula $\ell=1$
\end_inset

, which is the only possibility for 
\begin_inset Formula $C_{4\mathrm{v}}$
\end_inset

).
 The 
\begin_inset Formula $\frac{\pi}{2}$
\end_inset

 rotation is an exact symmetry of the geometry, so there is an exact degeneracy
 even for the numerical grid.
 For 
\begin_inset Formula $C_{6\mathrm{v}}$
\end_inset

, the symmetry group of the regular hexagon, as in this example of TE modes
 (with the transverse magnetic field 
\begin_inset Formula $H_{z}$
\end_inset

 shown) in a 2d slab with air holes (described in further detail in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Examples"

\end_inset

), the two eigenfunctions have no immediately obvious symmetry operation
 that transforms between them, but are in fact still degenerate (here 
\begin_inset Formula $\ell=1$
\end_inset

, and there also exists an 
\begin_inset Formula $\ell=2$
\end_inset

 irrep with its own degenerate pair).
 In all three cases (and in fact for all 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

), the standing-wave modes have mirror planes that are 
\begin_inset Formula $\frac{\pi}{2}$
\end_inset

 rotations from one another, and the two standing-wave modes have opposite
 parities across these mirror planes.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:overview"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Above threshold, the SALT equations 
\begin_inset CommandInset citation
LatexCommand cite
key "tureci_self-consistent_2006,ge_steady-state_2010,tureci_ab_2009"

\end_inset

 provide an elegant formulation of the problem of steady-state lasing modes:
 they analytically eliminate the time dependence from the Maxwellâ€“Bloch
 equations to obtain a nonlinear Maxwell-like eigenproblem 
\begin_inset Formula $\nabla\times\nabla\times\mathbf{E}_{\mu}=\omega_{\mu}^{2}\varepsilon_{\mathrm{SALT}}\mathbf{E}_{\mu}$
\end_inset

 for the lasing electric fields 
\begin_inset Formula $\mathbf{E}_{\mu}$
\end_inset

 and frequencies 
\begin_inset Formula $\omega_{\mu}$
\end_inset

, in which the permittivity 
\begin_inset Formula $\varepsilon_{\mathrm{SALT}}$
\end_inset

 depends nonlinearly on both the field and frequency (here, the speed of
 light 
\begin_inset Formula $c$
\end_inset

 has been set to unity).
 This equation can be efficiently solved numerically by adapting standard
 techniques from computational electromagnetism 
\begin_inset CommandInset citation
LatexCommand cite
key "direct_salt"

\end_inset

.
 As described below and also in previous work
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy,modeswitching2014"

\end_inset

, the SALT framework applies very naturally to lasing of degenerate microcavitie
s, assuming a stable degenerate steady state exists, but it turns out that
 there are two complications.
 First, in order to apply a numerical nonlinear solver to a large system
 of nonlinear equations like SALT, one needs to have a good 
\begin_inset Quotes eld
\end_inset

starting guess
\begin_inset Quotes erd
\end_inset

 for the solution.
 In the non-degenerate case, the starting guess is supplied by the threshold
 solution, but for a degenerate threshold there are infinitely many superpositio
ns.
 Picking the wrong starting guess, e.g.
 the 
\begin_inset Formula $\sin(m\phi)$
\end_inset

 mode in a ring, would lead SALT to converge to an unstable solutions, but
 our near-threshold perturbutation theory supplies us with a correct guess
 (which turns out to be the 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 analog of the circulating solution in the ring).
 
\end_layout

\begin_layout Standard
Second, there is a tricky complication that arises purely from 
\emph on
numerical
\emph default
 effects when a practical computational method is applied to spatially discretiz
e the SALT equations.
 In principle, what one would like to find from a degenerate SALT solver
 is a lasing mode (e.g.
 the clockwise circulating mode of a ring) with a passive pole (a pole of
 the Green's function linearized around the lasing solution) that coincides
 with the lasing frequency (there will be two possible lasing modes, e.g.
 clockwise and counterclockwise, but only one solution can exist at a time
 with nonzero amplitude due to the nonlinearity; which one is found will
 depend on the starting 
\begin_inset Quotes eld
\end_inset

guess
\begin_inset Quotes erd
\end_inset

 of the SALT solver).
 However, when one discretizes a microcavity geometry for a numerical solver,
 e.g.
 in a finite-difference or finite-element method, often the discretization
 itself breaks the symmetry and hence breaks the degeneracy slightly, causing
 the passive pole to separate from the lasing frequency.
 In a linear eigenproblem, this is at worst a minor annoyance, because from
 the symmetry group one can easily identify resonance modes that 
\begin_inset Quotes eld
\end_inset

should
\begin_inset Quotes erd
\end_inset

 be degenerate 
\begin_inset CommandInset citation
LatexCommand cite
key "inui_group,tinkham"

\end_inset

.
 In the nonlinear problem, however, the splitting can prevent the desired
 solution (e.g.
 the circulating mode) from existing in the SALT equations, because the
 solver can no longer pick arbitrary superpositions of the formerly degenerate
 modes, as described in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Forcing-the-degeneracy"

\end_inset

.
 (If the discretization breaks the degeneracy, but the pump strength is
 high enough, a single-mode circulating solution 
\emph on
may
\emph default
 still come back into existance, due to strong nonlinear self-interaction
 effects 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

.
 This effect can provide a fast and easy way to initially evaluate the field
 profile of a discretized geometry that is not exactly symmetric, and hence
 does not have an exact degeneracy.
 However, the conditions under which this effect can happen are not completely
 understood, as we explain in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:discretization_breaking"

\end_inset

, and we wish to deal with the discretization symmetry breaking in a more
 systematic and provably reliable manner.) To fix the problem of broken degenerac
y from discretization, we found a simple way to uniquely restore the degeneracy
 in a way that both guarantees convergence to the correct solution (as the
 discretization is refined), that generalizes to an arbitrary number of
 lasing modes (in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:multimode discretization method"

\end_inset

), and that is, at worst, a few times more computationally expensive than
 our non-degenerate solver.
\end_layout

\begin_layout Section
Background
\end_layout

\begin_layout Subsection
Review of SALT
\end_layout

\begin_layout Standard
The equations of SALT are derived from the Maxwell--Bloch equations 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-haken_laser_theory,ref-sauermann,haken_light:_1985,ref-lamb"

\end_inset

 (with the rotating-wave approximation):
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
-\varepsilon\ddot{\mathbf{E}}^{+} & =\nabla\times\nabla\times\mathbf{E}^{+}+\ddot{\mathbf{P}}^{+}\nonumber \\
i\dot{\mathbf{P}}^{+} & =(\omega_{a}-i\gamma_{\perp})\mathbf{P}^{+}+\gamma_{\perp}\mathbf{E}^{+}D\label{eq:maxwell--bloch}\\
\dot{D} & =\gamma_{\parallel}(D_{0}-D)+\mathrm{Im}(\mathbf{E}^{-}\cdot\mathbf{P}^{+}),\nonumber 
\end{align}

\end_inset

where 
\begin_inset Formula $\mathbf{E}^{+}(\mathbf{x},t)$
\end_inset

 is the 
\begin_inset Quotes eld
\end_inset

positive-frequency
\begin_inset Quotes erd
\end_inset

 component of the electric field [with 
\begin_inset Formula $\mathbf{E}^{-}=\mathbf{E}^{+\star}$
\end_inset

 and the physical field given by 
\begin_inset Formula $2\mathrm{Re}(\mathbf{E}^{+})$
\end_inset

], 
\begin_inset Formula $\varepsilon(\mathbf{x})$
\end_inset

 is the 
\begin_inset Quotes eld
\end_inset

cold-cavity
\begin_inset Quotes erd
\end_inset

 permittivity (not including the gain transition), 
\begin_inset Formula $\mathbf{P}(\mathbf{x},t)$
\end_inset

 is the polarization describing a transition (of frequency 
\begin_inset Formula $\omega_{a}$
\end_inset

 and linewidth 
\begin_inset Formula $\gamma_{\perp}$
\end_inset

) between two atomic energy levels, 
\begin_inset Formula $D(\mathbf{x},t)$
\end_inset

 is the population inversion between those two levels (with relaxation rate
 
\begin_inset Formula $\Gamma_{\Vert}$
\end_inset

), and 
\begin_inset Formula $D_{0}(\mathbf{x})$
\end_inset

 is the strength of a pumping process driving the inversion.
 Additionally, for convenience, one chooses units such that the following
 factors are set to unity: the dipole moment matrix element of the two level
 system, Planck's constant 
\begin_inset Formula $\hbar$
\end_inset

, and the speed of light 
\begin_inset Formula $c$
\end_inset

.
 Using the stationary inversion approximation 
\begin_inset Formula $D(\mathbf{x},t)\approx D(\mathbf{x})$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "fu_multifrequency_1991,tureci_self-consistent_2006"

\end_inset

 along with an ansatz of a finite number of lasing modes
\begin_inset Formula 
\begin{equation}
\mathbf{E}^{+}(\mathbf{x},t)=\sum_{\nu}\mathbf{E}_{\nu}(\mathbf{x})e^{-i\omega_{\nu}t},\label{eq:positive frequency component}
\end{equation}

\end_inset

where 
\begin_inset Formula $\omega_{\nu}$
\end_inset

 are the real mode frequencies, the second equation in Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:maxwell--bloch"

\end_inset

 is solved to eliminate 
\begin_inset Formula $\mathbf{P}^{+}$
\end_inset

 as an unknown, and the third equation becomes
\begin_inset Formula 
\begin{equation}
\dot{D}=\gamma_{\parallel}(D_{0}-D)+D\,\Im\left[\sum_{\mu\nu}\Gamma(\omega_{\nu})\mathbf{E}_{\mu}^{\star}\cdot\mathbf{E}_{\nu}e^{i(\omega_{\mu}-\omega_{\nu})t}\right],\label{eq:Ddot MB equation}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Gamma(\omega_{\mu})\equiv\gamma_{\perp}/(\omega_{\mu}-\omega_{a}+i\gamma_{\perp})$
\end_inset

.
 In order for the stationary inversion approximation 
\begin_inset Formula $\dot{D}=0$
\end_inset

 to be valid, the oscillating terms on the right-hand side of Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Ddot MB equation"

\end_inset

 must average to zero on a timescale much faster than the relaxation timescale
 
\begin_inset Formula $1/\gamma_{\parallel}$
\end_inset

; and in order to do so, the beating frequencies 
\begin_inset Formula $\omega_{\mu}-\omega_{\nu}$
\end_inset

 must be either exactly zero or much faster than the relaxation rate 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "fu_multifrequency_1991,tureci_self-consistent_2006,ge_steady-state_2010"

\end_inset

.
 This condition is evidently true when any pair of modes is either exactly
 degenerate, or situated very far apart from each other in frequency space.
 When these conditions are met, Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:maxwell--bloch"

\end_inset

 reduces to the SALT equation 
\begin_inset CommandInset citation
LatexCommand cite
key "ge_steady-state_2010,tureci_self-consistent_2006,tureci_ab_2009"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla\times\nabla\times\mathbf{E}_{\mu}=\omega_{\mu}^{2}\left[\varepsilon+\Gamma(\omega_{\mu})D\right]\mathbf{E}_{\mu},\label{eq:salt general}
\end{equation}

\end_inset

for the unknowns 
\begin_inset Formula $\mathbf{E}_{\mu}$
\end_inset

 and 
\begin_inset Formula $\omega_{\nu}$
\end_inset

, where 
\begin_inset Formula $D(\mathbf{x})$
\end_inset

 is the steady-state population inversion, which depends nonlinearly on
 the electric fields and lasing frequencies of all lasing modes: 
\begin_inset Formula 
\begin{equation}
D(\mathbf{x})=\frac{D_{0}(\mathbf{x})}{1+\gamma_{\parallel}^{-1}{\displaystyle \sum_{\nu}}\left|\Gamma(\omega_{\nu})\mathbf{E}_{\nu}\right|^{2}}.\label{eq:D(x) inversion}
\end{equation}

\end_inset

The intensity term in the denominator of Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:D(x) inversion"

\end_inset

 is known as the 
\begin_inset Quotes eld
\end_inset

spatial hole-burning
\begin_inset Quotes erd
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "tureci_self-consistent_2006,fu_multifrequency_1991,haken_light:_1985"

\end_inset

 term; it represents the saturation of the gain medium due to the total
 time-averaged intensity of all the lasing modes.
 Once Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:salt general"

\end_inset

 is solved for all the lasing modes 
\begin_inset Formula $\mathbf{E}_{\mu}$
\end_inset

 and frequencies 
\begin_inset Formula $\omega_{\mu}$
\end_inset

, one typically checks that the 
\begin_inset Quotes eld
\end_inset

passive
\begin_inset Quotes erd
\end_inset

 poles, i.e.
 the eigenvalues 
\begin_inset Formula $\tilde{\omega}_{\mu}$
\end_inset

 of the linearized SALT equation
\begin_inset Formula 
\begin{equation}
\nabla\times\nabla\times\tilde{\mathbf{E}}_{\mu}=\tilde{\omega}_{\mu}\left[\varepsilon+\Gamma(\tilde{\omega}_{\mu})D\right]\tilde{\mathbf{E}}_{\mu},\label{eq:passive pole salt}
\end{equation}

\end_inset

are not above the real axis.
 As long as 
\begin_inset Formula $\ensuremath{|\omega_{\nu}-\tilde{\omega}_{\mu}|\gg\gamma_{\parallel}}$
\end_inset

 (where 
\begin_inset Formula $\omega_{\nu}$
\end_inset

 are the lasing frequencies), this is a good indicator that the SALT solution
 is stable.
 However, a rigorous evaluation of the stability of the SALT solution requires
 a linear stability analysis based on the MB equations 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

.
 (In Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Stability-analysis summary"

\end_inset

, we give analytical results for this stability analysis for the near-threshold
 degenerate case.) 
\end_layout

\begin_layout Subsection
Effects of exact degeneracies
\end_layout

\begin_layout Standard
So far, most cases in which SALT has been applied have dealt with either
 single lasing modes or multimode regimes in which frequencies are far apart.
 When two lasing frequencies are close but not exactly degenerate, there
 is non-negligible beating and SALT is invalid.
 However, when two lasing modes are 
\emph on
exactly
\emph default
 degenerate, we find that SALT is still perfectly valid, because there is
 an exact steady-state solution of the MB equations (for a single lasing
 mode), provided that interference between the two degenerate modes is taken
 into account.
 Of course, it is possible that a degeneracy in the linear regime may split
 in the presence of the laser nonlinearity above threshold.
 However, if a degeneracy persists (and we have observed that it is guaranteed
 to do so for 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry-induced degeneracies, because of the 
\begin_inset Quotes eld
\end_inset

chiral
\begin_inset Quotes erd
\end_inset

 symmetry of the lasing mode as discussed in Appendix.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: degeneracy in Cn"

\end_inset

, our method will find it.
 The literature on degenerate lasing modes has almost invariably dealt with
 whispering-gallery modes in microdisks and ring resonators 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-cao_review,modeswitching2014,ref-matsko,ref-pnas_whispering"

\end_inset

.
 Many of these earlier works discussed the stability of traveling-wave modes
 in ring resonators under perturbations that break the symmetry 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-risken_instability,ref-bidirectional,ref-MBring,ref-breaking_cylindrical_symmetry,ref-tamm"

\end_inset

.
 A very limited number of other works on degenerate lasing modes in other
 geometries exist 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-braun"

\end_inset

, which were mostly experimental and focused on the linear cavity rather
 than the nonlinear lasing regime.
 However, the microdisk is only a single example of a setting where one
 can find degenerate resonant modes that can lase: there is a great variety
 of other symmetric geometries where degeneracies can occur 
\begin_inset CommandInset citation
LatexCommand cite
key "inui_group,tinkham,sakoda"

\end_inset

.
 So far, the  problem of above-threshold degenerate modes in lasers has
 not been studied systematically for the general 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 case.
 
\end_layout

\begin_layout Standard
The presence of degenerate eigenvalues in systems with 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry is a direct consequence of representation theory.
 For all 
\begin_inset Formula $n>2$
\end_inset

, there exists at least one two-dimensional irreducible representation (irrep)
 in each 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 [in fact, the number of two-dimensional irreps is 
\begin_inset Formula $\mathrm{floor}(\frac{n-1}{2})$
\end_inset

].
 For any linear operator that obeys 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry for some 
\begin_inset Formula $n$
\end_inset

 [such as the SALT operator (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:salt general"

\end_inset

) with a 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

-symmetric dielectric function 
\begin_inset Formula $\varepsilon(\mathbf{x})$
\end_inset

 and gain profile 
\begin_inset Formula $D_{0}(\mathbf{x})$
\end_inset

], any eigenfunction of the operator will in general belong to one of the
 irreps of the 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry group, and that eigenfunction will transform under symmetry operations
 of that group into linear combinations of eigenfunctions of the same irrep
 
\begin_inset CommandInset citation
LatexCommand cite
key "phc_book"

\end_inset

.
 For each such 2d irrep, there exist pairs of eigenfunctions that necessarily
 have the same eigenvalue 
\begin_inset CommandInset citation
LatexCommand cite
key "inui_group,tinkham"

\end_inset

.
 Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:overview"

\end_inset

 shows three examples of symmetric geometries, along with examples of degenerate
 eigenfunctions.
 
\end_layout

\begin_layout Standard
Ordinarily, SALT assumes that all distinct modes have distinct frequencies,
 i.e.
 
\begin_inset Formula $\omega_{\mu}\neq\omega_{\nu}$
\end_inset

 when 
\begin_inset Formula $\mu\neq\nu$
\end_inset

, which gives the stationary-inversion expression Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:D(x) inversion"

\end_inset

 when higher-frequency 
\begin_inset Formula $\omega_{\mu}-\omega_{\nu}$
\end_inset

 (
\begin_inset Formula $\nu\neq\mu$
\end_inset

) terms are dropped.
 However, when there are degeneracies, the MB equations will have terms
 of the form 
\begin_inset Formula $\mathbf{E}_{\mu}\cdot\mathbf{E}_{\nu}^{\star}$
\end_inset

 where 
\begin_inset Formula $\mu\neq\nu$
\end_inset

, since 
\begin_inset Formula $\omega_{\mu}=\omega_{\nu}$
\end_inset

 and one can no longer drop the 
\begin_inset Formula $e^{i(\omega_{\mu}-\omega_{\nu})t}$
\end_inset

 term.
 The correct expression for the stationary inversion will then be
\begin_inset Formula 
\begin{equation}
D=\frac{D_{0}}{1+\gamma_{\parallel}^{-1}\sum^{\prime}\Gamma_{\mu}\mathbf{E}_{\mu}\cdot\Gamma_{\nu}^{\star}\mathbf{E}_{\nu}^{\star}},\label{eq:Dcorrect}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Gamma_{\mu}\equiv\Gamma(\omega_{\mu})$
\end_inset

 and 
\begin_inset Formula $\sum^{\prime}$
\end_inset

 indicates a summation over all 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\nu$
\end_inset

 for which 
\begin_inset Formula $\omega_{\mu}=\omega_{\nu}$
\end_inset

, not just for 
\begin_inset Formula $\mu=\nu$
\end_inset

.
 To illustrate the difference between the two, we examine a case in which
 there are three lasing modes, two of which are degenerate with each other
 (
\begin_inset Formula $\omega_{1}=\omega_{2}\neq\omega_{3}$
\end_inset

).
 Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:D(x) inversion"

\end_inset

 will have
\begin_inset Formula 
\begin{equation}
\left|\Gamma_{1}\mathbf{E}_{1}\right|^{2}+\left|\Gamma_{2}\mathbf{E}_{2}\right|^{2}+\left|\Gamma_{3}\mathbf{E}_{3}\right|^{2}
\end{equation}

\end_inset

in the denominator, while Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Dcorrect"

\end_inset

 will have
\begin_inset Formula 
\begin{equation}
\left|\Gamma_{1}(\mathbf{E}_{1}+\mathbf{E}_{2})\right|^{2}+\left|\Gamma_{3}\mathbf{E}_{3}\right|^{2}.\label{eq:E123}
\end{equation}

\end_inset

From Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:E123"

\end_inset

 we see that the degenerate pair acts as a single mode that is a superposition
 of 
\begin_inset Formula $\mathbf{E}_{1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{2}$
\end_inset

.
 This means that the solution to the lasing degenerate problem can be portrayed
 in two equivalent pictures.
 First, we can think of the linear combination 
\begin_inset Formula $\mathbf{E}=\mathbf{E}_{1}+\mathbf{E}_{2}$
\end_inset

 as a single mode that satisfies the equation
\begin_inset Formula 
\begin{align}
-\nabla\times\nabla\times\mathbf{E} & =\omega_{1}^{2}\left(\varepsilon+D\Gamma_{1}\right)\mathbf{E}\nonumber \\
D & \equiv\frac{D_{0}}{1+\gamma_{\parallel}^{-1}\left(\left|\Gamma_{1}\mathbf{E}\right|^{2}+\left|\Gamma_{3}\mathbf{E}_{3}\right|^{2}\right)}\label{eq:1mode_salt}
\end{align}

\end_inset

[where the external pump 
\begin_inset Formula $D_{0}(\mathbf{x})$
\end_inset

 may be spatially dependent, as noted before].
 Second, we can think of the two modes as 
\emph on
separately 
\emph default
satisfying the two equations
\begin_inset Formula 
\begin{align}
-\nabla\times\nabla\times\mathbf{E}_{1,2} & =\omega_{1}^{2}\left(\varepsilon+D\Gamma_{1}\right)\mathbf{E}_{1,2}\nonumber \\
D & \equiv\frac{D_{0}}{1+\gamma_{\parallel}^{-1}\left(\left|\Gamma_{1}(\mathbf{E}_{1}+\mathbf{E}_{2})\right|^{2}+\left|\Gamma_{3}\mathbf{E}_{3}\right|^{2}\right)}.\label{eq:2mode_salt}
\end{align}

\end_inset

The existence of a solution to Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:1mode_salt"

\end_inset

 is a necessary but not sufficient condition for the existence of a solution
 to Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:2mode_salt"

\end_inset

.
 The reason is that Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:2mode_salt"

\end_inset

 enforces a double eigenvalue of the linearized eigenproblem (i.e.
 a double pole of the Green's function) on the real-
\begin_inset Formula $\omega$
\end_inset

 axis, whereas Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:1mode_salt"

\end_inset

 only enforces a single eigenvalue.
\end_layout

\begin_layout Standard
Prior to lasing, suppose that we have a 2-fold degenerate solution, correspondin
g to a double pole in the Green function.
 As the gain increases, and even when the system passes threshold and becomes
 nonlinear, poles can shift (and degeneracies may split) but poles do not
 appear or disappear discontinuously, so we should always expect there to
 be two poles (in the linearized Green's function around the SALT solution)
 arising from the original degenerate pair.
 Given this fact, if we solve the single-mode SALT equations as in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:1mode_salt"

\end_inset

, there is the danger that the other pole is unstable.
 As we show in Appendix.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix stability calculations"

\end_inset

, close to lasing threshold the zeroth order stability analysis (in the
 pump strength increment) simply depends on the SALT eigenproblem: if a
 SALT pole lies above the real-
\begin_inset Formula $\omega$
\end_inset

 axis, then lasing solution is necessarily unstable, whereas SALT poles
 below the real axis cannot induce instability.
 If a pole lies 
\emph on
on
\emph default
 the real axis, higher-order calculations are required to check stability
 as described in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Stability-analysis summary"

\end_inset

.
\end_layout

\begin_layout Standard
On the other hand, if we find a solution of the two-mode SALT equations
 as in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:2mode_salt"

\end_inset

, then by construction we have placed both poles together on the real-
\begin_inset Formula $\omega$
\end_inset

 axis and the other passive pole by itself is not a source of instability
 (and the overall stability of the Maxwellâ€“Bloch equations can be checked
 as in Ref.
 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

).
 However, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:2mode_salt"

\end_inset

 has a drawback: the hole-burning term now depends on the relative phase
 of 
\begin_inset Formula $\mathbf{E}_{1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{2}$
\end_inset

.
 In the original SALT equations, even for multimode problems, the phase
 was irrelevant and was chosen arbitrarily in order to obtain a solvable
 system of equations.
 If we remove the arbitrary phase choice, our equations (derived in Ref.
 
\begin_inset CommandInset citation
LatexCommand cite
key "direct_salt"

\end_inset

) become underdetermined.
 However, if we solve the single-mode equation (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:1mode_salt"

\end_inset

) but simultaneously constrain the other pole (the linearly independent
 degenerate partner) to be degenerate with the lasing pole, then we will
 effectively have solved Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:2mode_salt"

\end_inset

, and in the following sections we will explain how to implement this constraint.
\end_layout

\begin_layout Section
Threshold perturbation theory
\begin_inset CommandInset label
LatexCommand label
name "sec:Threshold-perturbation-theory"

\end_inset


\end_layout

\begin_layout Standard
In this section, we analyze the SALT (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:salt general"

\end_inset

) and Maxwell--Bloch equations (Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:maxwell--bloch"

\end_inset

) just above the lasing threshold in order to obtain insight about the nature
 of the degenerate solutions, as well as to determine the correct initial
 guess for the above-threshold regime (e.g.
 when solving for lasing modes using the method of Ref.
 
\begin_inset CommandInset citation
LatexCommand cite
key "direct_salt"

\end_inset

).
 For a regime with a single steady-state lasing mode 
\begin_inset Formula $\mathbf{E}^{+}(\mathbf{x},t)=\mathbf{E}(\mathbf{x})e^{-i\omega t}$
\end_inset

 with frequency 
\begin_inset Formula $\omega$
\end_inset

, one obtains a stationary inversion 
\begin_inset CommandInset citation
LatexCommand cite
key "tureci_self-consistent_2006,tureci_ab_2009,ge_steady-state_2010"

\end_inset

 
\begin_inset Formula $\dot{D}=0$
\end_inset

 and the single-mode SALT nonlinear eigenproblem
\begin_inset Formula 
\begin{equation}
\nabla\times\nabla\times\mathbf{E}=\omega^{2}\left[\varepsilon+\frac{D_{0}\Gamma(\omega)}{1+\gamma_{\parallel}^{-1}\left|\Gamma(\omega)\mathbf{E}\right|^{2}}\right]\mathbf{E}.\label{eq:single-mode-salt}
\end{equation}

\end_inset

The first lasing threshold occurs when 
\begin_inset Formula $D_{0}$
\end_inset

 in increased to a value 
\begin_inset Formula $D_{\mathrm{t}}$
\end_inset

 where a complex eigenvalue 
\begin_inset Formula $\omega$
\end_inset

 of this SALT equation with infinitesimal 
\begin_inset Formula $\mathbf{E}$
\end_inset

 hits the real-
\begin_inset Formula $\omega$
\end_inset

 axis (
\begin_inset Formula $\Im\,\omega=0$
\end_inset

) 
\begin_inset CommandInset citation
LatexCommand cite
key "tureci_self-consistent_2006,ge_steady-state_2010"

\end_inset

.
\end_layout

\begin_layout Standard
Now, we will consider the 
\emph on
near-threshold 
\emph default
problem 
\begin_inset Formula $D_{0}=D_{\mathrm{t}}(1+d)$
\end_inset

 for 
\begin_inset Formula $0\le d\ll1$
\end_inset

, for the case where the threshold mode (
\begin_inset Formula $d=0$
\end_inset

) is doubly degenerate, and expand the solutions to lowest order in 
\begin_inset Formula $d$
\end_inset

.
 First (Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Perturbative-SALT-solutions"

\end_inset

), we will solve the SALT equations perturbatively in 
\begin_inset Formula $d$
\end_inset

, in order to find the steady-state lasing solutions near threshold, regardless
 of whether they are stable.
 Then (Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Stability-analysis summary"

\end_inset

), we will plug those solutions into the full Maxwell--Bloch equations,
 again expanding to lowest-order in 
\begin_inset Formula $d$
\end_inset

, in order to evaluate the dynamical stability of the SALT modes.
 This yields a small 
\begin_inset Formula $4\times4$
\end_inset

 eigenproblem, whose eigenvalues determine the stability, and whose matrix
 elements are integrals of the threshold solutions.
 In the case of 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry, we know enough about the modes in order to simplify many of these
 calculations analytically, to conclude: (i) the only SALT solutions are
 either standing-wave or circulating solutions (defined below); (ii) the
 standing-wave modes are unstable for all 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 cases (except for a small group of isolated, realistically unattainable
 examples when 
\begin_inset Formula $n$
\end_inset

 is a multiple of four), and otherwise the stability can be determined by
 evaluating a simple integral of the threshold modes.
\end_layout

\begin_layout Subsection
Perturbative lasing solutions near threshold
\begin_inset CommandInset label
LatexCommand label
name "sub:Perturbative-SALT-solutions"

\end_inset


\end_layout

\begin_layout Standard
We begin with the situation of a degenerate threshold, where two modes 
\begin_inset Formula $\mathbf{E}_{1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{2}$
\end_inset

 (such as any of the pairs in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:overview"

\end_inset

) hit threshold at the same pump strength 
\begin_inset Formula $D_{\mathrm{t}}$
\end_inset

 and same frequency 
\begin_inset Formula $\omega_{\mathrm{t}}$
\end_inset

.
 Since the frequencies are the same, we can consider any linear superposition
 of the two modes as a single mode.
 With infinitesimal amplitude, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:single-mode-salt"

\end_inset

 is
\begin_inset Formula 
\begin{equation}
\nabla\times\nabla\times\mathbf{E}_{1,2}=\omega_{\mathrm{t}}^{2}\left(\varepsilon+D_{\mathrm{t}}\Gamma_{\mathrm{t}}\right)\mathbf{E}_{1,2},\label{eq:threshold salt}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Gamma_{\mathrm{t}}=\Gamma(\omega_{\mathrm{t}})$
\end_inset

.
 Now we perturb the pump strength to bring the mode slightly above threshold,
 with 
\begin_inset Formula $D_{0}=D_{\mathrm{t}}(1+d)$
\end_inset

 and 
\begin_inset Formula $0<d\ll1$
\end_inset

.
 We then expect the lasing mode slightly above threshold to be of the form
\begin_inset Formula 
\begin{align}
\mathbf{E} & =\Gamma_{\mathrm{t}}^{-1}\sqrt{\gamma_{\parallel}d}\left(a_{1}\mathbf{E}_{1}+a_{2}\mathbf{E}_{2}\right)+d^{3/2}\delta\mathbf{E},\nonumber \\
\omega & =\omega_{\mathrm{t}}+\omega_{1}d+\mathcal{O}(d^{2})\label{eq:lasing_ansatz}
\end{align}

\end_inset

where the complex coefficients 
\begin_inset Formula $a_{1,2}$
\end_inset

 and the real eigenvalue shift 
\begin_inset Formula $\omega_{1}$
\end_inset

 are to be determined.
 The linear relation between 
\begin_inset Formula $d$
\end_inset

 and intensity 
\begin_inset Formula $|\mathbf{E}|^{2}$
\end_inset

 has previously been shown for lasing modes above threshold in SPA-SALT
 approximation 
\begin_inset CommandInset citation
LatexCommand cite
key "ge_steady-state_2010"

\end_inset

.
 Inserting Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:lasing_ansatz"

\end_inset

 into Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:single-mode-salt"

\end_inset

, expanding to lowest order in 
\begin_inset Formula $d$
\end_inset

, and taking the inner product of both sides with 
\begin_inset Formula $\mathbf{E}_{1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{2}$
\end_inset

 (as performed in detail in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix allowed lasing modes"

\end_inset

), we obtain the pair of nonlinear equations for 
\begin_inset Formula $a_{1,2}$
\end_inset

 and 
\begin_inset Formula $\omega_{1}$
\end_inset

:
\begin_inset Formula 
\begin{multline}
0=\int d^{3}x\,\mathbf{E}_{1,2}\cdot\left(a_{1}\mathbf{E}_{1}+a_{2}\mathbf{E}_{2}\right)\times\\
\left[\omega_{1}\frac{\partial}{\partial\omega_{\mathrm{t}}}\omega_{\mathrm{t}}^{2}(\varepsilon+D_{\mathrm{t}}\Gamma_{\mathrm{t}})+\omega_{\mathrm{t}}^{2}D_{\mathrm{t}}\Gamma_{\mathrm{t}}\left(1-\left|a_{1}\mathbf{E}_{1}+a_{2}\mathbf{E}_{2}\right|^{2}\right)\right]\label{eq:a eigenproblem}
\end{multline}

\end_inset

To proceed, we must choose a basis 
\begin_inset Formula $\mathbf{E}_{1,2}$
\end_inset

 to work with (the end result, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:lasing_ansatz"

\end_inset

 turns out to be independent of the choice, as expected).
 One possible choice is the even and odd (with respect to the mirror planes
 of the 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 geometry) standing-wave modes, which we denote as 
\begin_inset Formula $\mathbf{E}_{\mathrm{even}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{\mathrm{odd}}$
\end_inset

 (as in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:overview"

\end_inset

).
 However, it turns out that another choice makes the analytical solution
 of Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:a eigenproblem"

\end_inset

 significantly easier to obtain, due to various convenient symmetry properties.
 In particular, we construct a basis of 
\emph on
clockwise 
\emph default
and 
\emph on
counterclockwise 
\emph default

\begin_inset Quotes eld
\end_inset

circulating
\begin_inset Quotes erd
\end_inset

 modes (analogous to 
\begin_inset Formula $e^{\pm i\ell\phi}$
\end_inset

 modes in a ring)
\begin_inset Formula 
\begin{equation}
\mathbf{E}_{\pm}=\sum_{k=1}^{n}\exp\left(\pm\frac{2\pi i\ell k}{n}\right)R_{k/n}\mathbf{E}_{\mathrm{even}},\label{eq:chiral definition}
\end{equation}

\end_inset

where 
\begin_inset Formula $\ell$
\end_inset

 is given by the 2d irrep that 
\begin_inset Formula $\mathbf{E}_{\mathrm{even}}$
\end_inset

 belongs to [
\begin_inset Formula $\ell$
\end_inset

 ranges from 1 to 
\begin_inset Formula $\mathrm{floor}(\frac{n-1}{2})$
\end_inset

], and 
\begin_inset Formula $R_{k/n}$
\end_inset

 is a counterclockwise rotation of the vector field 
\begin_inset Formula $\mathbf{E}_{\mathrm{even}}(\mathbf{x})$
\end_inset

 in the plane of the 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry by 
\begin_inset Formula $2\pi k/n$
\end_inset

 (if 
\begin_inset Formula $\ell$
\end_inset

 is chosen to be the wrong integer, then 
\begin_inset Formula $\mathbf{E}_{\pm}$
\end_inset

 vanishes because Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:chiral definition"

\end_inset

 is a projection operator 
\begin_inset CommandInset citation
LatexCommand cite
key "inui_group,tinkham"

\end_inset

).
 With this definition, 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{-}$
\end_inset

 are mirror flips of one another, and they span the same space as 
\begin_inset Formula $\mathbf{E}_{\mathrm{even}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{\mathrm{odd}}$
\end_inset

.
 One important property of the 
\begin_inset Formula $\mathbf{E}_{\pm}$
\end_inset

 is that they transform according to the chiral 
\begin_inset Formula $1d$
\end_inset

 irreps of the 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry group, i.e.
 
\begin_inset Formula $R_{1/n}\mathbf{E}_{\pm}=\exp\left(\mp\frac{2\pi i\ell k}{n}\right)\mathbf{E}_{\pm}$
\end_inset

.
 This fact will turn out to greatly simplify some upcoming calculations.
 Choosing 
\begin_inset Formula $\mathbf{E}_{1}=\mathbf{E}_{+}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{2}=\mathbf{E}_{-}$
\end_inset

 and exploiting the symmetry properties of this basis, we see (as shown
 in detail in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix allowed lasing modes"

\end_inset

) that Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:a eigenproblem"

\end_inset

 reduces to
\begin_inset Formula 
\begin{multline}
0=a_{\mp}\left(\omega_{1}H+G_{D}\right)-\\
a_{\mp}\left|a_{\pm}\right|^{2}\left(I+J\right)-a_{\mp}\left|a_{\mp}\right|^{2}I-a_{\pm}^{2}a_{\mp}^{\star}K,\label{eq:reduced a plus minus}
\end{multline}

\end_inset

where the coefficients 
\begin_inset Formula $G_{D}$
\end_inset

, 
\begin_inset Formula $H$
\end_inset

, 
\begin_inset Formula $I$
\end_inset

, 
\begin_inset Formula $J$
\end_inset

, and 
\begin_inset Formula $K$
\end_inset

 are simple integrals of the threshold modes, given in closed form in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:G and H definitions"

\end_inset

 and Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:I J K definitions"

\end_inset

.
 Equation.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:reduced a plus minus"

\end_inset

 can be solved in closed form (as performed in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix allowed lasing modes"

\end_inset

), and yields only a few solutions.
 First, there are the purely circulating modes, given by
\begin_inset Formula 
\begin{align}
\mathbf{E} & =\Gamma_{\mathrm{t}}^{-1}\sqrt{\frac{\left(\omega_{1}H+G_{D}\right)\gamma_{\parallel}d}{I}}\mathbf{E}_{\pm}\nonumber \\
\omega_{1} & =-\frac{\mathrm{Im}\left(G_{D}/I\right)}{\mathrm{Im}\left(H/I\right)}.\label{eq:circulating lasing}
\end{align}

\end_inset

The other solutions to Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:reduced a plus minus"

\end_inset

 are 
\emph on
standing-wave 
\emph default
modes, as to be expected, and it turns out their form depends (as explained
 in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix allowed lasing modes"

\end_inset

) crucially on whether the irrep of the degenerate pair satisfies 
\begin_inset Formula $n=4\ell$
\end_inset

, where again 
\begin_inset Formula $\ell$
\end_inset

 is the order of the 2d irrep.
 For 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 with 
\begin_inset Formula $n\neq4\ell$
\end_inset

, the other modes are
\begin_inset Formula 
\begin{align}
\mathbf{E} & =\Gamma_{\mathrm{t}}^{-1}\sqrt{\frac{(\omega_{1}H+G_{D})\gamma_{\parallel}d}{2I+J}}\left(\mathbf{E}_{+}+e^{i\theta}\mathbf{E}_{-}\right)\nonumber \\
\omega_{1} & =-\frac{\mathrm{Im}\left(G_{D}/[2I+J]\right)}{\mathrm{Im}\left(H/[2I+J]\right)}\label{eq:n != 4 lasing}
\end{align}

\end_inset

where 
\begin_inset Formula $\theta$
\end_inset

 is an arbitrary phase angle.
 (During numerical solution of Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:single-mode-salt"

\end_inset

, we have found that for some 
\begin_inset Formula $n$
\end_inset

, there seem to be constraints on 
\begin_inset Formula $\theta$
\end_inset

, namely having to be a multiple of 
\begin_inset Formula $\frac{\pi}{n}$
\end_inset

.
 These constraints probably come from equations that are higher-order in
 
\begin_inset Formula $d$
\end_inset

 than our perturbation theory.
 However, they are inconsequential because it turns out that these standing-wave
 modes are always unstable, regardless of 
\begin_inset Formula $\theta$
\end_inset

.) On the other hand, for the case of 
\begin_inset Formula $n=4\ell$
\end_inset

, there are 
\emph on
two 
\emph default
sets of standing-wave modes.
 The first is
\begin_inset Formula 
\begin{align}
\mathbf{E} & =\Gamma_{\mathrm{t}}^{-1}\sqrt{\frac{(\omega_{1}H+G_{D})\gamma_{\parallel}d}{2I+J+K}}\left(\mathbf{E}_{+}\pm\mathbf{E}_{-}\right)\nonumber \\
\omega_{1} & =-\frac{\mathrm{Im}\left(G_{D}/[2I+J+K]\right)}{\mathrm{Im}\left(H/[2I+J+K]\right)}\label{eq:E+ + E- lasing}
\end{align}

\end_inset

and the other is
\begin_inset Formula 
\begin{align}
\mathbf{E} & =\Gamma_{\mathrm{t}}^{-1}\sqrt{\frac{(\omega_{1}H+G_{D})\gamma_{\parallel}d}{2I+J-K}}\left(\mathbf{E}_{+}\pm i\mathbf{E}_{-}\right)\nonumber \\
\omega_{1} & =-\frac{\mathrm{Im}\left(G_{D}/[2I+J-K]\right)}{\mathrm{Im}\left(H/[2I+J-K]\right)}.\label{eq:E+ + i E- lasing}
\end{align}

\end_inset

These four sets of solutions turn out to constitute all the solutions of
 Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:reduced a plus minus"

\end_inset

 for the general 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 case, and this completes the solution of Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:single-mode-salt"

\end_inset

 slightly above threshold.
 Figure.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:n=5 numerical results"

\end_inset

 shows a comparison of numerical results for a 1d 
\begin_inset Formula $C_{5\mathrm{v}}$
\end_inset

 laser with the predictions of perturbation theory.
 
\end_layout

\begin_layout Standard
In order to find out which of these solutions is the one that actually lases
 in a real 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 system, we must test stability of each of these solutions.
 It turns out that this test can also be done mostly analytically, using
 perturbation theory on the linearized Maxwell--Bloch equations, as we will
 present in the next section.
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename n5fig/n5amp.pdf
	lyxscale 30
	scale 44

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename n5fig/n5omega.pdf
	lyxscale 30
	scale 43

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Lasing amplitudes (top) and frequency shifts (bottom) for 1d laser (periodic
 geometry with 
\begin_inset Formula $0<x<1$
\end_inset

) with uniform dielectric 
\begin_inset Formula $\varepsilon(x)=1+0.3i$
\end_inset

 and gain profile 
\begin_inset Formula $D_{0}(x)=D_{\mathrm{t}}(1+d)[1+0.2\cos(2\pi nx)]$
\end_inset

.
 Here, we have chosen 
\begin_inset Formula $n=5$
\end_inset

, so the gain has 
\begin_inset Formula $C_{5\mathrm{v}}$
\end_inset

 symmetry, and the discretization had 
\begin_inset Formula $N=150$
\end_inset

 grid points.
 Data points were obtained by solving Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:single-mode-salt"

\end_inset

 (SALT) numerically using Newton's method 
\begin_inset CommandInset citation
LatexCommand cite
key "direct_salt"

\end_inset

, while theoretical lines were provided by Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:circulating lasing"

\end_inset

 and Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:n != 4 lasing"

\end_inset

.
 For the standing mode, numerical results are independent of relative phase
 
\begin_inset Formula $\theta$
\end_inset

, as predicted by Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:n != 4 lasing"

\end_inset

.
 Agreement between numerics and theory is excellent for mode amplitudes
 (up to at least 
\begin_inset Formula $d\approx100$
\end_inset

 [not shown in the figure], and possibly much higher) but only good at 
\begin_inset Formula $d<0.005$
\end_inset

 for frequency shifts.
 For the numerical data in the amplitude plot, only the magnitude of the
 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

 component (obtained by taking the normalized inner product of the lasing
 mode 
\begin_inset Formula $\mathbf{E}$
\end_inset

 with 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

) of both the circulating and standing-wave modes are shown.
 For the 
\begin_inset Formula $\mathbf{E}_{-}$
\end_inset

 component, the circulating mode had magnitude zero and the standing mode
 had the same magnitude as the 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

 component.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:n=5 numerical results"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Perturbative stability analysis
\begin_inset CommandInset label
LatexCommand label
name "sub:Stability-analysis summary"

\end_inset


\end_layout

\begin_layout Standard
While these three forms of lasing modes all solve SALT near threshold, and
 hence are 
\begin_inset Quotes eld
\end_inset

fixed-point
\begin_inset Quotes erd
\end_inset

 equilibria of the Maxwell--Bloch equations, one intuitively expects that
 only the circulating mode will be stable.
 The reason is that standing-wave modes for the 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 group have zero amplitude along certain lines, most obviously along 
\begin_inset Formula $x=0$
\end_inset

 for the 
\begin_inset Formula $\mathbf{E}_{\mathrm{odd}}$
\end_inset

 mode, and those zero-amplitude regions are making no use of the gain.
 This allows the opposite-symmetry standing-wave mode to grow exponentially
 into these nulls, and this is the reason why the sine and cosine modes
 are unstable in a ring.
 (This fact is only true for 
\emph on
exact 
\emph default
degeneracies; for real systems, which almost always break the degeneracy,
 there may be small regions near threshold where the standing-wave mode
 is stable 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-sorel"

\end_inset

.) To quantify this intuition, we perform linear-stability analysis, along
 the same lines as the numerical procedure in Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

.
 We linearize the Maxwell--Bloch equations for small perturbations around
 the SALT modes, by inserting
\begin_inset Formula 
\begin{align}
\mathbf{E}^{+}(\mathbf{x},t) & =\left[\mathbf{E}(\mathbf{x})+\delta\mathbf{E}(\mathbf{x},t)\right]e^{-i\omega t}\nonumber \\
\mathbf{P}^{+}(\mathbf{x},t) & =\left[\mathbf{P}(\mathbf{x})+\delta\mathbf{P}(\mathbf{x},t)\right]e^{-i\omega t}\label{eq:ansatz-1}\\
D(\mathbf{x},t) & =D(\mathbf{x})+\delta D(\mathbf{x},t)\nonumber 
\end{align}

\end_inset

into the Maxwell--Bloch equations (where 
\begin_inset Formula $\mathbf{E}$
\end_inset

 is any of the SALT solutions obtained in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Perturbative-SALT-solutions"

\end_inset

, 
\begin_inset Formula $D(\mathbf{x})$
\end_inset

 is the stationary inversion given in 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:single-mode-salt"

\end_inset

, 
\begin_inset Formula $\omega$
\end_inset

 is the lasing frequency given in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:lasing_ansatz"

\end_inset

, and 
\begin_inset Formula $\mathbf{P}(\mathbf{x})=\Gamma(\omega)\mathbf{E}(x)D$
\end_inset

, is the polarization field.
 We collect terms order-by-order in the perturbations 
\begin_inset Formula $\delta$
\end_inset

.
 The zeroth-order equations are simply the SALT equations and are already
 satisfied by construction by 
\begin_inset Formula $\mathbf{E}$
\end_inset

, 
\begin_inset Formula $\mathbf{P}$
\end_inset

, and 
\begin_inset Formula $D(\mathbf{x})$
\end_inset

.
 The first-order equations are 
\begin_inset Formula 
\begin{align}
0 & =-\nabla\times\nabla\times\delta\mathbf{E}+\left(\frac{d}{dt}-i\omega\right)^{2}(\varepsilon\delta\mathbf{E}+\delta\mathbf{P})\nonumber \\
i\delta\dot{\mathbf{P}} & =(\omega_{a}-\omega-i\gamma_{\perp})\delta\mathbf{P}+\gamma_{\perp}(D\delta\mathbf{E}+\mathbf{E}\delta D)\label{eq:delta}\\
\delta\dot{D} & =-\gamma_{\parallel}\delta D+\mathrm{Im}(\mathbf{P}\cdot\delta\mathbf{E}^{\star}+\mathbf{E}^{\star}\cdot\delta\mathbf{P}).\nonumber 
\end{align}

\end_inset

Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:delta"

\end_inset

 can be written as a matrix equation
\begin_inset Formula 
\begin{equation}
\left(\mathsf{C}\frac{d^{2}}{dt^{2}}+\mathsf{B}\frac{d}{dt}+\mathsf{A}\right)\mathsf{u}(t)=0\label{eq:time-dependent quadratic}
\end{equation}

\end_inset

or alternatively a quadratic eigenvalue problem 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-tisseur_quadratic_review"

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathsf{C}\sigma^{2}+\mathsf{B}\sigma+\mathsf{A}\right)\mathsf{x}=0\label{eq:quadratic eigenproblem}
\end{equation}

\end_inset

where the unknown vector is
\begin_inset Formula 
\begin{equation}
\mathsf{u}(t)=\left(\begin{array}{c}
\Re\,\delta\vec{E}\\
\Im\,\delta\vec{E}\\
\Re\,\delta\vec{P}\\
\Im\,\delta\vec{P}\\
\delta\vec{D}
\end{array}\right)=\Re\left(\mathsf{x}e^{\sigma t}\right).
\end{equation}

\end_inset

The goal of the stability analysis is to find the eigenvalues 
\begin_inset Formula $\sigma$
\end_inset

 for a given lasing mode 
\begin_inset Formula $\mathbf{E}$
\end_inset

.
 If the real part of any of the eigenvalues 
\begin_inset Formula $\sigma$
\end_inset

 is positive, then the lasing mode is unstable, while if all the eigenvalues
 have non-positive real parts, then the lasing mode is stable (with some
 technical care for zero eigenvalues and structural stability, described
 in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix stability calculations"

\end_inset

).
 Ref.
 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

 discretized Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:delta"

\end_inset

 to obtain Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:quadratic eigenproblem"

\end_inset

 and then solved the resulting matrix equation numerically to find the eigenvalu
es 
\begin_inset Formula $\sigma$
\end_inset

 and hence evaluate the SALT stability for any pump strength above threshold.
 Here, we focus on the regime slightly above threshold, and show that the
 equations can be solved analytically to lowest order in 
\begin_inset Formula $d$
\end_inset

, and this is enough to evaluate near-threshold stability.
 We begin by noting that the matrices can be expanded as
\begin_inset Formula 
\begin{align}
\mathsf{A} & =\mathsf{A}_{0}+\mathsf{A}_{1/2}\sqrt{d}+\mathsf{A}_{1}d+\mathcal{O}(d^{3/2})\nonumber \\
\mathsf{B} & =\mathsf{B}_{0}+\mathsf{B}_{1}d+\mathcal{O}(d^{2})\label{eq:matrix expansion}\\
\mathsf{C} & =\mathsf{C}_{0}\nonumber 
\end{align}

\end_inset

(where 
\begin_inset Formula $d$
\end_inset

 is the relative pump increment above threshold, as introduced in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Threshold-perturbation-theory"

\end_inset

), since the matrices come from the coefficients of Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:delta"

\end_inset

 and contain the lasing solutions 
\begin_inset Formula $\mathbf{E}$
\end_inset

 and other associated fields 
\begin_inset Formula $\mathbf{P}$
\end_inset

 and 
\begin_inset Formula $D$
\end_inset

.
 As a result, the eigenvalues and eigenvectors can also be expanded this
 way:
\begin_inset Formula 
\begin{align}
\mathsf{x} & =\mathsf{x}_{0}+\mathsf{x}_{1/2}\sqrt{d}+\mathsf{x}_{1}d+\mathcal{O}(d^{3/2})\nonumber \\
\sigma & =\sigma_{0}+\sigma_{1/2}\sqrt{d}+\sigma_{1}d+\mathcal{O}(d^{3/2}).\label{eq:eigenpair expansion}
\end{align}

\end_inset

We insert Eqs.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:matrix expansion"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:eigenpair expansion"

\end_inset

 into Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:quadratic eigenproblem"

\end_inset

 and solve order-by-order in 
\begin_inset Formula $\sqrt{d}$
\end_inset

 until a non-zero 
\begin_inset Formula $\sigma$
\end_inset

 is found, as explained in detail in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix stability calculations"

\end_inset

.
 At zeroth order, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:quadratic eigenproblem"

\end_inset

 is equivalent to the SALT equation at threshold (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:threshold salt"

\end_inset

), and has two kinds of solutions.
 First, there are the below threshold 
\begin_inset Quotes eld
\end_inset

passive
\begin_inset Quotes erd
\end_inset

 modes 
\begin_inset CommandInset citation
LatexCommand cite
key "tureci_self-consistent_2006,ge_steady-state_2010"

\end_inset

, which have 
\begin_inset Formula $\Re(\sigma_{0})<0$
\end_inset

 (because for these modes, 
\begin_inset Formula $\sigma_{0}$
\end_inset

 is simply the difference 
\begin_inset Formula $\tilde{\omega}-\omega_{\mathrm{t}}$
\end_inset

 between the complex pole 
\begin_inset Formula $\tilde{\omega}$
\end_inset

 of the passive mode and the real threshold frequency 
\begin_inset Formula $\omega_{\mathrm{t}}$
\end_inset

) and hence are stable.
 Therefore, when 
\begin_inset Formula $d$
\end_inset

 is small enough, we can say for certain that having one of these 
\begin_inset Formula $\sigma_{0}$
\end_inset

 above the real axis would make the system unstable, so having all passive
 poles of the SALT equation be below the real axis is a 
\emph on
necessary 
\emph default
condition for lasing near threshold, for small 
\begin_inset Formula $d$
\end_inset

.
 (Far above threshold, however, this is no longer true, as shown in Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

.) Second, from the degenerate 
\emph on
threshold
\emph default
 modes, we obtain
\begin_inset Formula 
\begin{align}
\sigma_{0} & =0\nonumber \\
\mathsf{x}_{0} & =\sum_{k=1}^{4}b_{k}\mathsf{v}_{k},\label{eq:zeroth order}
\end{align}

\end_inset

where 
\begin_inset Formula $b_{k}$
\end_inset

 are arbitrary complex coefficients that will determined later at higher
 order (similarly to linear degenerate perturbation theory in quantum mechanics
 
\begin_inset CommandInset citation
LatexCommand cite
key "sakurai"

\end_inset

), and the vectors 
\begin_inset Formula $\mathsf{v}_{k}$
\end_inset

 are
\begin_inset Formula 
\begin{equation}
\mathsf{v}_{k}=\left(\begin{array}{c}
\Re\,\vec{e}_{k}\\
\Im\,\vec{e}_{k}\\
D_{\mathrm{t}}\Re\,(\Gamma_{\mathrm{t}}\vec{e}_{k})\\
D_{\mathrm{t}}\Im\,(\Gamma_{\mathrm{t}}\vec{e}_{k})\\
0
\end{array}\right),\label{eq:vk definition}
\end{equation}

\end_inset

where we have defined 
\begin_inset Formula $\mathbf{e}_{1,2,3,4}=\mathbf{E}_{1},\mathbf{E}_{2},i\mathbf{E}_{1},i\mathbf{E}_{2}$
\end_inset

 (again, 
\begin_inset Formula $\mathbf{E}_{1,2}$
\end_inset

 are any two threshold solutions to Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:threshold salt"

\end_inset

).
 It is shown in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix stability calculations"

\end_inset

 that the eigenvalue at the next order, 
\begin_inset Formula $\sigma_{1/2}$
\end_inset

 is also zero.
 Hence, stability is determined by 
\begin_inset Formula $\sigma_{1}$
\end_inset

.
 At order 
\begin_inset Formula $d$
\end_inset

, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:quadratic eigenproblem"

\end_inset

 is 
\begin_inset Formula 
\begin{equation}
(\mathsf{B}_{0}\sigma_{1}+\mathsf{A}_{1})\mathsf{x}_{0}+\mathsf{A}_{1/2}\mathsf{x}_{1/2}+\mathsf{A}_{0}\mathsf{x}_{1}=0.\label{eq:first order equation}
\end{equation}

\end_inset

Here, all quantities except 
\begin_inset Formula $\sigma_{1}$
\end_inset

 and 
\begin_inset Formula $\mathsf{x}_{1}$
\end_inset

 are known.
 Because 
\begin_inset Formula $\sigma_{0}=0$
\end_inset

, we have 
\begin_inset Formula $\mathsf{A}_{0}\mathsf{v}_{k}=0$
\end_inset

.
 There are also left eigenvectors 
\begin_inset CommandInset citation
LatexCommand cite
key "strang_linear_algebra"

\end_inset

 
\begin_inset Formula $\mathsf{w}_{j}$
\end_inset

 that satisfy 
\begin_inset Formula $\mathsf{A}_{0}^{T}\mathsf{w}_{j}=0$
\end_inset

.
 By acting on Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:first order equation"

\end_inset

 with these left eigenvectors, we obtain a 
\begin_inset Formula $4\times4$
\end_inset

 
\emph on
linear 
\emph default
eigenvalue problem for the eigenvalue 
\begin_inset Formula $\sigma_{1}$
\end_inset

 and the eigenvectors (whose elements are the coefficients 
\begin_inset Formula $b_{k}$
\end_inset

 in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:zeroth order"

\end_inset

).
 We can then, in a straightforward fashion, write down the eigenvalues and
 eigenvectors in closed form.
 While the procedure we have just described can be done with any basis 
\begin_inset Formula $\mathbf{E}_{1,2}$
\end_inset

, again, it is most convenient to choose the basis 
\begin_inset Formula $\mathbf{E}_{\pm}$
\end_inset

, due to the symmetry properties which greatly simplify the calculation.
 Here, we present the results, leaving the detailed derivation to Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix stability calculations"

\end_inset

.
\end_layout

\begin_layout Standard
For the circulating lasing modes in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:circulating lasing"

\end_inset

, the four eigenvalues are
\begin_inset Formula 
\begin{align}
\sigma_{1} & =0\nonumber \\
\sigma_{1} & =2\Im\left(\frac{I}{H}\right)\left|a\right|^{2}\nonumber \\
\sigma_{1} & =\left(\Im\left(\frac{J}{H}\right)+\sqrt{\left|\frac{K}{H}\right|^{2}-\Re\left(\frac{J}{H}\right)^{2}}\right)\left|a\right|^{2}\label{eq:circulating eigenvalues}\\
\sigma_{1} & =\left(\Im\left(\frac{J}{H}\right)-\sqrt{\left|\frac{K}{H}\right|^{2}-\Re\left(\frac{J}{H}\right)^{2}}\right)\left|a\right|^{2},\nonumber 
\end{align}

\end_inset

where 
\begin_inset Formula $|a|^{2}\equiv\frac{\omega_{1}H+G_{D}}{I}$
\end_inset

.
 The first eigenvalue comes from the global phase degree of freedom for
 lasing solutions 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

.
 For the other three eigenvalues, we have found empirically that the real
 part is always negative, indicating that the circulating modes are stable.
 Although we have been unable to prove that 
\begin_inset Formula $\Re(\sigma_{1})<0$
\end_inset

 in general for the last three values in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:circulating eigenvalues"

\end_inset

, we have empirically observed this to be true, and it is easily checked
 in any case by integrating the threshold modes and computing 
\begin_inset Formula $H$
\end_inset

, 
\begin_inset Formula $I$
\end_inset

, 
\begin_inset Formula $J$
\end_inset

, and 
\begin_inset Formula $K$
\end_inset

.
\end_layout

\begin_layout Standard
For the 
\begin_inset Formula $n\neq4\ell$
\end_inset

 standing lasing modes in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:n != 4 lasing"

\end_inset

, the eigenvalues are given by
\begin_inset Formula 
\begin{align}
\sigma_{1} & =0\nonumber \\
\sigma_{1} & =0\nonumber \\
\sigma_{1} & =2\Im\left(\frac{2I+J}{H}\right)\left|a\right|^{2}\label{eq:n != 4 stability eigenvalues}\\
\sigma_{1} & =-2\Im\left(\frac{J}{H}\right)\left|a\right|^{2},\nonumber 
\end{align}

\end_inset

where 
\begin_inset Formula $|a|^{2}\equiv\frac{\omega_{1}H+G_{D}}{2I+J}$
\end_inset

.
 Here, both zero eigenvalues come from continuous degrees of freedom: one
 comes from the global phase degree of freedom, while the other comes from
 the relative phase between 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{-}$
\end_inset

 in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:n != 4 lasing"

\end_inset

, which can take any value (as explained previously, this degree of freedom
 is likely removed at higher orders in 
\begin_inset Formula $d$
\end_inset

, so that only certain linear combinations, namely the 
\begin_inset Formula $n$
\end_inset

-fold rotations of 
\begin_inset Formula $\mathbf{E}_{\mathrm{even}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{\mathrm{odd}}$
\end_inset

, are actually lasing solutions).
 For TM modes in 2d, which have 
\begin_inset Formula $\mathbf{E}=E\hat{\mathbf{z}}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "phc_book"

\end_inset

, it can be shown that 
\begin_inset Formula $I=J$
\end_inset

, so at least one of the two non-zero eigenvalues here must have a positive
 real part (in practice, it is always the last eigenvalue), indicating that
 these standing lasing modes are always unstable.
 Figure.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:n=5 stability results"

\end_inset

 shows a comparison between the theoretical first-order approximation and
 the exact numerical values of the circulating and standing-wave stability
 eigenvalues for a 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 case with 
\begin_inset Formula $n=5$
\end_inset

.
\end_layout

\begin_layout Standard
For the 
\begin_inset Formula $n=4\ell$
\end_inset

 standing-wave modes, we first have the 
\begin_inset Formula $\mathbf{E}_{+}\pm\mathbf{E}_{-}$
\end_inset

 solutions in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:E+ + E- lasing"

\end_inset

, which have the eigenvalues
\begin_inset Formula 
\begin{align}
\sigma_{1} & =0\nonumber \\
\sigma_{1} & =2\Im\left(\frac{2I+J+K}{H}\right)|a|^{2}\nonumber \\
\sigma_{1} & =\left[-\Im\left(\frac{J+3K}{H}\right)+\rho\right]|a|^{2}\label{eq:stability eigenvalues for E+ + E-}\\
\sigma_{1} & =\left[-\Im\left(\frac{J+3K}{H}\right)-\rho\right]|a|^{2}\nonumber \\
\rho & \equiv\sqrt{\Im\left(\frac{J-K}{H}\right)^{2}-8\Re\left(\frac{K}{H}\right)\Re\left(\frac{J+K}{H}\right)},\nonumber 
\end{align}

\end_inset

where 
\begin_inset Formula $|a|^{2}\equiv\frac{\omega_{1}H+G_{D}}{2I+J+K}$
\end_inset

.
 Again, there is a zero eigenvalue coming from the global phase degree of
 freedom.
 For almost all cases, we have empirically observed that the second eigenvalue
 has a negative real part, but also 
\begin_inset Formula $-\Im\left(\frac{J+3K}{H}\right)>0$
\end_inset

, and hence the third and fourth eigenvalues are unstable.
 However, there are pathological cases where the gain profile 
\begin_inset Formula $D_{0}(\mathbf{x})$
\end_inset

 can be chosen (e.g.
 in terms of 
\begin_inset Formula $4\ell$
\end_inset

 delta functions) so that 
\begin_inset Formula $J=-K$
\end_inset

, upon which the third eigenvalue is stable, and the last eigenvalue is
 zero.
 This zero eigenvalue turns out to become positive (unstable) for physical,
 finite-sized gain regions, as discussed further in Appendix.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix stability calculations"

\end_inset

.
\end_layout

\begin_layout Standard
Finally, we have the 
\begin_inset Formula $\mathbf{E}_{+}\pm i\mathbf{E}_{-}$
\end_inset

 solutions for the 
\begin_inset Formula $n=4\ell$
\end_inset

 case in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:E+ + i E- lasing"

\end_inset

.
 The eigenvalues are
\begin_inset Formula 
\begin{align}
\sigma_{1} & =0\nonumber \\
\sigma_{1} & =2\Im\left(\frac{2I+J-K}{H}\right)|a|^{2}\nonumber \\
\sigma_{1} & =\left[\Im\left(\frac{3K-J}{H}\right)+\eta\right]|a|^{2}\label{eq:stability eigenvalues for E+ + iE-}\\
\sigma_{1} & =\left[\Im\left(\frac{3K-J}{H}\right)-\eta\right]|a|^{2}\nonumber \\
\eta & \equiv\sqrt{\Im\left(\frac{J+K}{H}\right)^{2}+8\Re\left(\frac{K}{H}\right)\Re\left(\frac{J-K}{H}\right)},\nonumber 
\end{align}

\end_inset

where 
\begin_inset Formula $|a|^{2}\equiv\frac{\omega_{1}H+G_{D}}{2I+J-K}$
\end_inset

.
 Again, in most cases we have empirically found that the second eigenvalue
 is stable while the third and fourth are unstable.
 However, there are pathological delta-function cases where the external
 pump profile 
\begin_inset Formula $D_{0}(\mathbf{x})$
\end_inset

 can be chosen in a specific way (different from that for the 
\begin_inset Formula $\mathbf{E}_{+}\pm\mathbf{E}_{-}$
\end_inset

 solutions) such that 
\begin_inset Formula $J=K$
\end_inset

, and the third eigenvalue is stable while the fourth is zero.
 Again, this zero eigenvalue becomes positive (unstable) for finite-size
 gain regions, and so this marginal case is unlikely to be of practical
 importance.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename n5fig/n5circ_stability.pdf
	lyxscale 30
	scale 42

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename n5fig/n5stand_stability.pdf
	lyxscale 30
	scale 42

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Stability eigenvalues for the circulating (top) and standing (bottom) lasing
 modes from Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:n=5 numerical results"

\end_inset

.
 For each lasing mode, the four lowest eigenvalues obtained using the numerical
 procedure of Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

 are matched against the four eigenvalues found in perturbation theory.
 In the top panel, a zero eigenvalue is clearly seen, coming from the global
 phase freedom.
 The real parts of the third and fourth values of Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:circulating eigenvalues"

\end_inset

 are equal, so two of the curves coincide.
 None of the other eigenvalues go above the real axis, indicating that the
 circulating mode is stable.
 For the bottom panel, there are two zero eigenvalues, in agreement with
 Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:n != 4 stability eigenvalues"

\end_inset

.
 One of the other two eigenvalues becomes positive, indicating that the
 standing lasing mode is not stable.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:n=5 stability results"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We note that the absence of a positive value for 
\begin_inset Formula $\sigma_{1}$
\end_inset

 for the circulating lasing mode does not guarantee that the true eigenvalue
 
\begin_inset Formula $\sigma$
\end_inset

 (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:eigenpair expansion"

\end_inset

) will remain below the real axis for all 
\begin_inset Formula $d$
\end_inset

.
 Indeed, Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

 (Fig.
\begin_inset space ~
\end_inset

1 in the reference) found an instance of a 1d uniform ring laser where,
 for certain regimes, the circulating mode actually becomes unstable above
 a certain 
\begin_inset Formula $d_{\mathrm{cutoff}}$
\end_inset

.
 The instability comes from one of the four Maxwell--Bloch stability eigenvalues
 associated with the degenerate threshold pair (whose first-order coefficients
 are given in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:circulating eigenvalues"

\end_inset

) going above the real axis.
 However, the onset of the instability depends on the value of 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

, the relaxation rate of the inversion, and the eigenvalues in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:circulating eigenvalues"

\end_inset

 are independent of that parameter, so the effect must come from higher
 orders.
 Closer inspection of the data in the ring laser of Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

 shows that for very small 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

, the cutoff pump strength 
\begin_inset Formula $d_{\mathrm{cutoff}}$
\end_inset

 is linear with 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

; that is, the circulating mode is stable for 
\begin_inset Formula $d<z_{0}\gamma_{\parallel}$
\end_inset

,where 
\begin_inset Formula $z_{0}$
\end_inset

 is a constant independent of 
\begin_inset Formula $d$
\end_inset

 and 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

.
 In Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix stability calculations"

\end_inset

, we rigorously explain this criterion by extending the perturbation theory
 used to obtain 
\begin_inset Formula $\sigma_{1}$
\end_inset

 and finding the 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

 dependence to all orders in 
\begin_inset Formula $d$
\end_inset

 (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:s expansion"

\end_inset

).
\end_layout

\begin_layout Subsection
Threshold perturbation examples
\begin_inset CommandInset label
LatexCommand label
name "sec:threshold_perturbation_Examples"

\end_inset


\end_layout

\begin_layout Standard
Now, we illustrate the ideas of threshold perturbation theory with an example
 of a symmetric geometry with degeneracies: a dielectric square.
 Unlike in a metal square (with Dirichlet boundary conditions), the equation
 for the electric field is not separable in the 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 directions.
 The modes 
\begin_inset Formula $\mathbf{E}_{1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{2}$
\end_inset

 are shown in the middle panel of Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:overview"

\end_inset

.
 The stable linear combination is the circulating mode predicted by Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Stability-analysis summary"

\end_inset

.
 As a consequence of including interference between the two standing-wave
 modes 
\begin_inset Formula $\mathbf{E}_{\mathrm{even}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{\mathrm{odd}}$
\end_inset

, this intensity pattern 
\begin_inset Formula $\left|\mathbf{E}_{\mathrm{even}}\pm i\mathbf{E}_{\mathrm{odd}}\right|$
\end_inset

 is chiral (with 
\begin_inset Formula $C_{4}$
\end_inset

 symmetry) while a naive summation of the individual intensities 
\begin_inset Formula $|\mathbf{E}_{\mathrm{even}}|^{2}+|\mathbf{E}_{\mathrm{odd}}|^{2}$
\end_inset

 would still yield a 
\begin_inset Formula $C_{4\mathrm{v}}$
\end_inset

 pattern, as shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lowQ_chirality"

\end_inset

.
 Because 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry groups have no 2d irreps, we would expect the degeneracy to split.
 However, a key point is that the degeneracy indeed persists even when 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry becomes 
\begin_inset Formula $C_{n}$
\end_inset

, as explained in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix allowed lasing modes"

\end_inset

.
 Since this degeneracy does not come from geometric symmetry alone, there
 is no clear symmetry operation that takes the lasing mode (center panel
 of Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lowQ_chirality"

\end_inset

) to its degenerate partner (right panel), but there is still an exact degenerac
y due to Lorentz reciprocity 
\begin_inset CommandInset citation
LatexCommand cite
key "dichroism"

\end_inset

, as explained in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix allowed lasing modes"

\end_inset

.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename lowQ_square/lowQsquare_wrong.png
	lyxscale 20
	scale 25

\end_inset


\begin_inset Formula $\;$
\end_inset


\begin_inset Graphics
	filename lowQ_square/lowQsquare_intensity.png
	lyxscale 20
	scale 25

\end_inset


\begin_inset Formula $\;$
\end_inset


\begin_inset Graphics
	filename lowQ_square/counter.png
	lyxscale 20
	scale 25

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The incorrect (left) intensity pattern, correct (center) intensity pattern
 for the pair of low-
\begin_inset Formula $Q$
\end_inset

 dielectric square modes, slightly above threshold (the pattern remains
 essentially the same even for much higher pump strengths), and degenerate
 passive mode of opposite chirality (right) of low-
\begin_inset Formula $Q$
\end_inset

 dielectric square for lasing very high above threshold (
\begin_inset Formula $D_{0}=100\Dt)$
\end_inset

.
 The left intensity pattern was obtained by solving two-mode SALT without
 any interference effects, while the center pattern was obtained by constructing
 the stable linear combination predicted by symmetry and perturbation theory
 and then solving single-mode SALT.
 The correct pattern clearly has a chirality, which the incorrect pattern
 lacks.
 The profile on the right is not simply a mirror flip of the lasing mode,
 but is in fact degenerate with it, as explained in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix allowed lasing modes"

\end_inset

.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:lowQ_chirality"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Effects of chirality 
\begin_inset CommandInset label
LatexCommand label
name "sec:Effects-of-chirality"

\end_inset


\end_layout

\begin_layout Standard
In this section, we discuss the effects of chirality.
 So far, we have worked with 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 geometries, which are symmetric under 
\begin_inset Formula $n$
\end_inset

-fold rotations and flip operations across the mirror planes 
\begin_inset CommandInset citation
LatexCommand cite
key "inui_group,tinkham"

\end_inset

.
 However, if the mirror symmetry is broken, then we no longer have 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry: while there is still symmetry under 
\begin_inset Formula $n$
\end_inset

-fold rotations, the geometry aquires a certain 
\begin_inset Quotes eld
\end_inset

handedness
\begin_inset Quotes erd
\end_inset

, as in the last two panels of Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lowQ_chirality"

\end_inset

.
 These symmetry groups are known as 
\begin_inset Formula $C_{n}$
\end_inset

, and have different consquences for lasing modes arising from these geometries,
 as we discuss below.
 
\end_layout

\begin_layout Standard
There are two ways for mirror symmetry to be broken: first, for a 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

-symmetric geometry [dielectric function 
\begin_inset Formula $\varepsilon(\mathbf{x})$
\end_inset

 and gain profile 
\begin_inset Formula $D_{0}(\mathbf{x})$
\end_inset

], the intensity patterns of the circulating modes (given in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:chiral definition"

\end_inset

, and which we have empirically observed are always the only stable modes)
 turn out to have 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry as opposed to 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry due to spontaneous breaking of mirror symmetry as soon as the
 mode starts lasing (the only exception to this rule is for a 
\begin_inset Formula $C_{\infty\mathrm{v}}$
\end_inset

 system, in which the circulating lasing modes have an intensity pattern
 
\begin_inset Formula $|\mathbf{E}|^{2}\propto|e^{i\ell\phi}|^{2}=1$
\end_inset

, and hence still have mirror symmetry).
 We have also empirically observed that circulating lasing modes in 
\emph on
lossy
\emph default
 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

-symmetric cavities (such as that in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lowQ_chirality"

\end_inset

), those with low quality factor 
\begin_inset CommandInset citation
LatexCommand cite
key "phc_book"

\end_inset

 
\begin_inset Formula $Q\equiv-\Re\,\omega^{\prime}/\Im\,\omega^{\prime}$
\end_inset

, where 
\begin_inset Formula $\omega^{\prime}$
\end_inset

 is the passive [zero pump] pole in the Green's function, tend to have greater
 chirality than circulating modes in cavities with 
\emph on
high 
\emph default

\begin_inset Formula $Q$
\end_inset

 (such as that in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:phc_stable"

\end_inset

).
 Second, the geometry itself can already have 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry, e.g.
 the dielectric and gain functions themselves have chirality.
 Whether the chirality is due to the intensity pattern of a lasing mode
 or due to the geometry itself, the effects are the same.
\end_layout

\begin_layout Standard
First, the presence of chirality affects the nature of the degeneracy between
 the lasing mode and its passive pole, e.g.
 the solution to Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:passive pole salt"

\end_inset

.
 For a laser with 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry at threshold, the two chiral circulating modes, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:chiral definition"

\end_inset

 are exactly related to each other by a mirror-flip operation.
 As soon as 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

 starts lasing, the mirror symmetry is broken (for 
\begin_inset Formula $n\neq\infty$
\end_inset

) and the passive pole, which we denote as 
\begin_inset Formula $\tilde{\mathbf{E}}_{-}$
\end_inset

, will move further and further away from being the mirror flip of 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

 (as seen in the right panel of Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lowQ_chirality"

\end_inset

).
 It is important to note that if 
\begin_inset Formula $\mathbf{E}_{-}$
\end_inset

 were to lase instead of 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

, then the 
\emph on
lasing 
\emph default
mode 
\begin_inset Formula $\mathbf{E}_{-}$
\end_inset

 will be an exact mirror flip of 
\begin_inset Formula $\mathbf{E_{+}}$
\end_inset

, while the eigenfunction of its passive pole 
\begin_inset Formula $\tilde{\mathbf{E}}_{+}$
\end_inset

 will be an exact mirror flip of 
\begin_inset Formula $\tilde{\mathbf{E}}_{-}$
\end_inset

, due to the 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry at threshold.
 The lasing frequency 
\begin_inset Formula $\omega$
\end_inset

 will also be independent of whether 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

 or 
\begin_inset Formula $\mathbf{E}_{-}$
\end_inset

 lases, as confirmed by Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:circulating lasing"

\end_inset

.
 On the other hand, if the laser already had 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry at threshold (either due to chirality in a previously lasing mode
 or in the dielectric or gain functions), then the threshold eigenfunctions
 
\begin_inset Formula $\mathbf{E}_{\pm}$
\end_inset

 are no longer mirror flips of each other, even though their threshold frequenci
es are both the same 
\begin_inset Formula $\omega_{\mathrm{t}}$
\end_inset

 (as an interesting consequence of Lorentz reciprocity of Maxwell's equations,
 as reviewed in Appendix.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: degeneracy in Cn"

\end_inset

).
 The fact that 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{-}$
\end_inset

 are not mirror flips of each other causes a splitting between the overlap
 integrals 
\begin_inset Formula $I_{+}$
\end_inset

 and 
\begin_inset Formula $I_{-}$
\end_inset

, as well as in 
\begin_inset Formula $J_{\pm}$
\end_inset

 and 
\begin_inset Formula $H_{\pm}$
\end_inset

.
 As a consequence, the expressions for the amplitude 
\begin_inset Formula $|a|$
\end_inset

 and the frequency shift 
\begin_inset Formula $\omega_{1}$
\end_inset

 in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:circulating lasing"

\end_inset

 will have 
\begin_inset Formula $I_{+}$
\end_inset

 if 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

 lases, and 
\begin_inset Formula $I_{-}$
\end_inset

 if 
\begin_inset Formula $\mathbf{E}_{-}$
\end_inset

 lases.
 Hence, if the symmetry is only 
\begin_inset Formula $C_{n}$
\end_inset

 at threshold, the clockwise and counterclockwise lasing modes would also
 have different amplitudes and frequencies, in addition to not being related
 to each other by a mirror flip operation.
 These facts allow us to imagine a situation in which there is a 
\begin_inset Quotes eld
\end_inset

binary tree
\begin_inset Quotes erd
\end_inset

 of allowed possibilities, e.g.
 the first degenerate pair lases in clockwise mode, the second in counterclockwi
se, and so on.
\end_layout

\begin_layout Standard
Second, the presence of chirality affects the perturbation theory results
 for standing-mode lasing solutions in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Threshold-perturbation-theory"

\end_inset

.
 When the threshold symmetry is 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

, there exist standing-mode solutions of the form 
\begin_inset Formula $\mathbf{E}\propto\mathbf{E}_{+}+e^{i\theta}\mathbf{E}_{-}$
\end_inset

 (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:n != 4 lasing"

\end_inset

) when 
\begin_inset Formula $n\neq4\ell$
\end_inset

, and standing-wave modes of the form 
\begin_inset Formula $\mathbf{E}\propto\mathbf{E}_{+}\pm\mathbf{E}_{-}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{+}\pm i\mathbf{E}_{-}$
\end_inset

 when 
\begin_inset Formula $n=4\ell$
\end_inset

.
 However, when the threshold symmetry is 
\begin_inset Formula $C_{n}$
\end_inset

, there are no longer any standing-mode lasing solutions for the 
\begin_inset Formula $n\neq4\ell$
\end_inset

 case.
 In the 
\begin_inset Formula $n=4\ell$
\end_inset

 case, however, we have found empirically that the standing-mode solutions
 
\begin_inset Formula $\mathbf{E}_{+}\pm\mathbf{E}_{-}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{+}\pm i\mathbf{E}_{-}$
\end_inset

 still exist (provided that the correct normalization and overall phase
 of 
\begin_inset Formula $\mathbf{E}_{-}$
\end_inset

 is chosen appropriately).
 However, because of the splitting in the values of the overlap integrals
 
\begin_inset Formula $I_{\pm}$
\end_inset

, 
\begin_inset Formula $J_{\pm}$
\end_inset

, and 
\begin_inset Formula $K_{\pm}$
\end_inset

 for the 
\begin_inset Formula $C_{n}$
\end_inset

 case, the stability eigenvalues (Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Stability-analysis summary"

\end_inset

) for these standing-mode solutions will no longer be given by the simple
 expressions in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:stability eigenvalues for E+ + E-"

\end_inset

 and Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:stability eigenvalues for E+ + iE-"

\end_inset

, and will have to be numerically computed (nevertheless, we have empirically
 found that these standing-mode solutions are still unstable).
\end_layout

\begin_layout Subsection
Multimode lasing
\end_layout

\begin_layout Standard
So far, the discussion and examples in this paper have dealt with the case
 in which only one pair of degenerate modes are lasing.
 The generalization to the case of multimode lasing (i.e.
 multiple nondegenerate and degenerate lasing modes all lasing simultaneously)
 is straightforward.
 Since our method combines degenerate pairs into a single mode that is the
 stable linear combination (as given by the perturbation theory in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Threshold-perturbation-theory"

\end_inset

, the multimode treatment is exactly the same as for SALT without degeneracies:
 the degenerate pairs are always treated as a single mode.
 As in previous work on SALT 
\begin_inset CommandInset citation
LatexCommand cite
key "ge_steady-state_2010,tureci_self-consistent_2006,direct_salt"

\end_inset

, all lasing modes are solved simultaneously at first, and there the collective
 effect of their spatial hole-burning is used to track the passive modes
 and add any mode (degenerate or nondegenerate) that crosses threshold to
 the list of lasing modes.
 The only aspects of our method requiring generalization are the threshold
 perturbation theory of Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Threshold-perturbation-theory"

\end_inset

 and the 
\emph on
quadratic program
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "boyd"

\end_inset

 (QP) method of Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Forcing-the-degeneracy"

\end_inset

.
 For both aspects, we describe small tweaks to the methods presented in
 those sections that make them valid for the case of multimode lasing.
\end_layout

\begin_layout Standard
A general situation in which multimode-lasing is occuring can be described
 by Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:salt general"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "ge_steady-state_2010,tureci_self-consistent_2006"

\end_inset

, where there are 
\begin_inset Formula $M$
\end_inset

 lasing modes (
\begin_inset Formula $\mu=1,2,\ldots,M$
\end_inset

).
 If we start with 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry and have lasing modes that are either circulating modes (as in
 Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Stability-analysis summary"

\end_inset

) or non-degenerate modes (partners of 
\emph on
real
\emph default
 1d irreps without a corresponding complex-conjugate irrep of the opposite
 chirality), then each of the 
\begin_inset Formula $\left|\mathbf{E}_{\nu}\right|^{2}$
\end_inset

 terms has at least 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry, so the full stationary inversion 
\begin_inset Formula $D(\mathbf{x})$
\end_inset

, which includes the effects of spatial hole-burning, has 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry.
 Suppose that the pump strength is at the threshold of mode 
\begin_inset Formula $M$
\end_inset

 so that this mode has just started lasing, and that only modes 
\begin_inset Formula $1$
\end_inset

 through 
\begin_inset Formula $M-1$
\end_inset

 contribute to the spatial hole-burning.
 Then all results in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Threshold-perturbation-theory"

\end_inset

 still hold, except with gain profile 
\begin_inset Formula $D_{0}(\mathbf{x})$
\end_inset

 replaced by 
\begin_inset Formula $D(\mathbf{x})$
\end_inset

.
 While the gain profile is now 
\begin_inset Formula $C_{n}$
\end_inset

 symmetric rather than 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

, the presence of chiral degenerate pairs (which requires only 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry and Lorentz reciprocity, as explained in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix allowed lasing modes"

\end_inset

) still remains, as explained in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Stability-analysis summary"

\end_inset

 (the arguments in that section do not assume 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry, so they still hold even if 
\begin_inset Formula $D_{0}(\mathbf{x})$
\end_inset

 is replaced by a function with only 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry.
\end_layout

\begin_layout Section
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 Symmetry broken by discretization
\begin_inset CommandInset label
LatexCommand label
name "sec:discretization_breaking"

\end_inset


\end_layout

\begin_layout Standard
In many cases the 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

-symmetric geometry we are trying to solve has a degeneracy that is broken
 when the geometry is approximated by a discretized grid for numerical solution
 on a computer 
\begin_inset CommandInset citation
LatexCommand cite
key "champagne_fdfd,taflove,direct_salt"

\end_inset

, since the grid may no longer have the original 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry.
 For linear equations, this unphysical splitting is not an issue because
 it is usually straightforward to tell whether a pair of modes is 
\begin_inset Quotes eld
\end_inset

really
\begin_inset Quotes erd
\end_inset

 degenerate by how it corresponds to the eigenfunctions of the 
\begin_inset Quotes eld
\end_inset

real
\begin_inset Quotes erd
\end_inset

 symmetry group, and since all linear superpositions solve the equation
 in the infinite-resolution limit, we can construct arbitrary superpositions
 as needed 
\emph on
after 
\emph default
solving for both of the modes.
 However, for SALT (which is nonlinear), the coefficients of the superposition
 is a physical quantity that must be found by our solution method, as explained
 in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Stability-analysis summary"

\end_inset

.
 As explained in Ref.
 
\begin_inset CommandInset citation
LatexCommand cite
key "direct_salt"

\end_inset

, the process for solving for lasing modes begins with the linear problem
 for the passive poles.
 Because both the real and imaginary parts of the passive poles are split
 by the discretization error, the modes will lase at different pump strengths,
 and even after both modes lase we cannot construct a linear combination
 of them because the two modes satisfy equations with different real eigenfreque
ncies.
 
\end_layout

\begin_layout Standard
When the pump strength is sufficiently high above threshold, however, the
 two near-degenerate modes can interact with each other via the nonlinear
 spatial hole burning interaction to form a single stable laser mode.
 This effect is commonly known as cooperative frequency locking 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-lugiato-josa,ref-tamm"

\end_inset

.
 For example, Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

 found instances where artificially breaking a degeneracy on purpose, such
 as by introducing a wedge to a single location on the rim of a ring laser,
 can result in the circulating mode not existing near threshold as expected,
 but coming back 
\emph on
into
\emph default
 existence (once the pump strength is high enough above threshold and the
 nonlinearity is strong enough) as a modified version that is not perfectly
 
\begin_inset Quotes eld
\end_inset

circulating
\begin_inset Quotes erd
\end_inset

, but nearly so.
 We have found similar results in hexagonal (
\begin_inset Formula $C_{6\mathrm{v}})$
\end_inset

 structures 
\emph on
without 
\emph default
artifically-introduced defects, in which the degeneracy is broken by discretizat
ion alone.
 There, a circulating single-mode lasing solution starts existing above
 a certain pump strength (somewhat higher than threshold), even though there
 is no degeneracy at threshold.
 The reason the circulating lasing mode requires a minimum pump strength
 is that the nonlinearity must be strong enough to counteract the broken
 degeneracy and to lock the two modes to a single frequency.
 In many cases such as these, numerically solving the single mode problem,
 using an artificially-constructed circulating solution as an initial guess,
 results in the solver correctly converging to a circulating lasing mode.
 However, this effect is not yet completely understood, and it is not entirely
 predictable under what circumstances such a circulating mode exists.
 Furthermore, the pump window between the original lasing threshold and
 the threshold at which the stable circular mode emerges can not be described
 with SALT as the electric field no longer shows a multi-periodic time dependenc
y 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-lugiato-josa,ref-tamm"

\end_inset

.
 Moreover, a discretization-induced error and a physical perturbation breaking
 the degeneracy are two distinct effects (even if their consequences are
 mathematically similar), and it is important to be able to study them independe
ntly.
 When one is studying a physical symmetry-breaking defect, one does not
 want to accidentally observe an artificial effect of discretization instead.
 Consequently, degeneracy-splitting caused by discretization is a major
 practical problem for our SALT solver and requires a nontrivial solution.
 For a rigorous study of the circulating solution we therefore construct
 a small perturbation to the dielectric function to force a degeneracy in
 both the pump strength and the frequencies at threshold.
 We discuss this method below.
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename even_cylinder/evencos.png
	lyxscale 20
	scale 31

\end_inset


\begin_inset Formula $\quad$
\end_inset


\begin_inset Graphics
	filename even_cylinder/evensin.png
	lyxscale 20
	scale 31

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $\ell=8$
\end_inset

 threshold modes [
\begin_inset Formula $\Re(\mathbf{E}_{\mathrm{e,o}})$
\end_inset

] for cylinder with uniform dielectric 
\begin_inset Formula $\varepsilon=5$
\end_inset

 and radius 
\begin_inset Formula $r=1$
\end_inset

.
 Unlike in the odd-
\begin_inset Formula $\ell$
\end_inset

 case (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:overview"

\end_inset

), however, the discretized modes are 
\emph on
not
\emph default
 
\begin_inset Formula $\frac{\pi}{2}$
\end_inset

 rotations from each other.
 Consequently, there is an unphysical splitting, due to discretization,
 of 
\begin_inset Formula $0.11\%$
\end_inset

 in 
\begin_inset Formula $\mathrm{Re}(\omega_{1}-\omega_{2})$
\end_inset

 (for a resolution of 14 pixcels per wavelength) and 
\begin_inset Formula $11.5\%$
\end_inset

 in 
\begin_inset Formula $\mathrm{Im}(\omega_{1}-\omega_{2})$
\end_inset

 at zero pump strength (the latter being larger only because these are high-
\begin_inset Formula $Q$
\end_inset

 modes and 
\begin_inset Formula $\mathrm{Im}(\omega_{\mu})$
\end_inset

 is already very small at zero pump strength).
 A difference in imaginary parts also means a splitting in the threshold
 pump strength 
\begin_inset Formula $D_{\mathrm{t}}$
\end_inset

.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:even_cylinder_modes"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Restoring the degeneracy using a perturbation to the dielectric 
\begin_inset CommandInset label
LatexCommand label
name "sub:Forcing-the-degeneracy"

\end_inset


\end_layout

\begin_layout Standard
The basic idea is that we construct an artificial perturbation 
\begin_inset Formula $\delta\varepsilon(\mathbf{x})$
\end_inset

 to the dielectric permittivity that forces the degeneracy in both the frequency
 and threshold, and then we solve the perturbed single-mode SALT equation.
 There are infinitely many possible functions that can achieve this goal,
 so we look for the one with the smallest 
\begin_inset Formula $L_{2}$
\end_inset

 norm 
\begin_inset Formula $\left\Vert \delta\varepsilon(\mathbf{x})\right\Vert _{2}^{2}=\int\left|\delta\varepsilon(\mathbf{x})\right|^{2}$
\end_inset

.
 This is also reasonable because in the limit of infinite resolution, the
 perturbation required to force the degeneracy must approach zero.
 We construct the perturbation by solving a 
\emph on
quadratic program
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "boyd"

\end_inset

 (QP) with linear constraints which we obtain using perturbation theory.
 Not only does this uniquely (and cheaply) determine 
\begin_inset Formula $\delta\varepsilon$
\end_inset

, as described below, but it also guarantees convergence to the solution
 of the unperturbed (physical) single-mode SALT equation in the limit of
 infinite resolution.
 The reason it guarantees convergence is that the frequency splitting vanishes
 in the limit of infinite resolution, as shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:cylinder_resolution"

\end_inset

 and so the minimum-norm 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 to force a degeneracy also vanishes in the limit of infinite resolution,
 recovering the unperturbed SALT.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/cylinder_resolution.pdf
	lyxscale 30
	scale 40
	BoundingBox 0bp 160bp 612bp 630bp
	clip

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Splitting in degeneracy due to discretization error for even-
\begin_inset Formula $\ell$
\end_inset

 modes of dielectric cylinder versus the resolution 
\begin_inset Formula $1/h$
\end_inset

 of the discretization, where 
\begin_inset Formula $h$
\end_inset

 is the distance between adjacent gridpoints.
 The oscillations, which are due to the discontinuous interfaces between
 dielectric and air that 
\begin_inset Quotes eld
\end_inset

jump
\begin_inset Quotes erd
\end_inset

 when the resolution is changed, could in principle be smoothed by using
 subpixel averaging techniques for the discretization 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-subpixel"

\end_inset

.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:cylinder_resolution"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
It turns out that determining the minimum-norm 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 requires only that we solve a sequence of QP problems: minimizing a convex
 quadratic function (
\begin_inset Formula $\left\Vert \delta\varepsilon\right\Vert _{2}^{2}$
\end_inset

) of 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 subject to a linear constraint on 
\begin_inset Formula $\delta\varepsilon$
\end_inset

.
 QPs are convex optimization problems with a unique global minimum that
 can be efficiently found simply by solving a system of linear equations
 
\begin_inset CommandInset citation
LatexCommand cite
key "boyd"

\end_inset

.
 In particular, the linear constraint (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:degeneracy_forcing"

\end_inset

), which coalesces the eigenvalues, can be derived from perturbation theory.
 Because the perturbation theory is only first-order, however, the 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 that we find by solving the QP only approximately eliminates the splitting,
 but we can simply re-solve SALT and solve a new QP, iterating the process
 a few times (twice is typically enough) to force a degeneracy to machine
 precision.
 The full details of the procedure are given in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Determining-the-dielectric-perturbation"

\end_inset

.
\end_layout

\begin_layout Standard
The resulting 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 of this procedure applied to the even-
\begin_inset Formula $\ell$
\end_inset

 threshold modes in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:even_cylinder_modes"

\end_inset

 are shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:even_cylinder_deps"

\end_inset

, and the convergence of the splitting to zero is shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:even_cylinder_QP"

\end_inset

.
 As verified in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:deps_scale"

\end_inset

, the 
\begin_inset Formula $L_{2}$
\end_inset

 norm decreases with higher resolution, satisfying our requirement that
 the dielectric perturbation should go to zero in the continuum limit.
 Once the degeneracy is forced for a lasing mode, the frequencies may still
 split if the pump strength is further increased, since the intensity profile
 changes, and as a result, slightly shifts the 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 required to force the degeneracy to machine precision.
 However, we have found this splitting to be negligible, as in the example
 given in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:QP_stability"

\end_inset

, and that the correct circulating solution is still obtained.
 In general, the splitting is small when the intensity profiles of the lasing
 mode and its passive pole are similar, as in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:even_cylinder_intensity"

\end_inset

.
 In Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Determining-the-dielectric-perturbation"

\end_inset

, we give a method that re-forces the degeneracy for pump strengths above
 threshold, if a machine precision degeneracy is desired.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename even_cylinder/redeps.png
	lyxscale 20
	scale 27

\end_inset


\begin_inset Formula $\quad$
\end_inset


\begin_inset Graphics
	filename even_cylinder/imdeps.png
	lyxscale 20
	scale 27

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Dielectric perturbation 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 obtained by solving QP for threshold modes with 
\begin_inset Formula $\ell=8$
\end_inset

.
 The real part (left) has a dependence 
\begin_inset Formula $\cos(2\ell\phi)$
\end_inset

, while the imaginary part (right) is a more complicated function.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:even_cylinder_deps"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/qp.pdf
	lyxscale 30
	scale 40
	BoundingBox 0bp 160bp 612bp 630bp
	clip

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Relative splitting in threshold pump strength 
\begin_inset Formula $D_{t}$
\end_inset

 and frequency 
\begin_inset Formula $\omega_{t}$
\end_inset

 for even-
\begin_inset Formula $\ell$
\end_inset

 cylinder modes after QP iterations.
 The relative splitting in frequency is defined in the usual way as 
\begin_inset Formula $2\left|\frac{\omega_{1}-\omega_{2}}{\omega_{1}+\omega_{2}}\right|$
\end_inset

, and similarly for the pump strength.
 Only two iterations of QP were required reduce the splitting in both the
 threshold frequency 
\begin_inset Formula $\omega_{t}$
\end_inset

 and the threshold pump strength 
\begin_inset Formula $D_{\mathrm{t}}$
\end_inset

 to 
\begin_inset Formula $10^{-10}$
\end_inset

 or smaller.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:even_cylinder_QP"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/deps_scale.pdf
	lyxscale 30
	scale 40
	BoundingBox 0bp 160bp 612bp 630bp
	clip

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $L_{2}$
\end_inset

 norm of resulting 
\begin_inset Formula $\delta\varepsilon(\mathbf{x})$
\end_inset

 function obtained from QP procedure versus discretization resolution 
\begin_inset Formula $1/h$
\end_inset

 for nearly degenerate even-
\begin_inset Formula $\ell$
\end_inset

 modes of cylinder, where 
\begin_inset Formula $h$
\end_inset

 is the spacing between adjacent gridpoints.
 The same resolutions as in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:cylinder_resolution"

\end_inset

 were used, and the oscillations resemble the curve for splitting very closely.
 This is because the larger the splitting 
\begin_inset Formula $\omega_{2}-\omega_{1}$
\end_inset

, the larger the 
\begin_inset Formula $\delta\varepsilon(\mathbf{x})$
\end_inset

 function needed to enforce the degeneracy.
 The fact that 
\begin_inset Formula $\left\Vert \delta\varepsilon\right\Vert _{2}^{2}$
\end_inset

 appears to be going to zero as the resolution increases indicates that
 our QP procedure is convergent.
\begin_inset CommandInset label
LatexCommand label
name "fig:deps_scale"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/even_cylinder_stability.pdf
	lyxscale 30
	scale 40
	BoundingBox 0bp 160bp 612bp 630bp
	clip

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Above-threshold splitting in real and imaginary parts of 
\begin_inset Formula $\delta\omega^{\prime}$
\end_inset

 after performing QP procedure for even-
\begin_inset Formula $\ell$
\end_inset

 modes.
 The magnitude is very small because the intensity profile, as shown in
 Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:even_cylinder_intensity"

\end_inset

, is very close to
\emph on
 
\emph default
rotationally symmetric.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:QP_stability"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename even_cylinder/even_psiexpsq.png
	lyxscale 20
	scale 31

\end_inset


\begin_inset Formula $\quad$
\end_inset


\begin_inset Graphics
	filename even_cylinder/even_psisq_pass.png
	lyxscale 20
	scale 31

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Intensity profiles for even-
\begin_inset Formula $\ell$
\end_inset

 lasing mode and its second passive pole at 
\begin_inset Formula $d=100$
\end_inset

.
 The intensity of the lasing mode (left) differs imperceptibly from that
 of that of the passive eigenfunction.
 This difference is unphysical because it is solely due to discretization
 error, and is usually so small that it can be neglected.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:even_cylinder_intensity"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Example with 
\begin_inset Formula $C_{6\mathrm{v}}$
\end_inset

 symmetry
\begin_inset CommandInset label
LatexCommand label
name "sub:Examples"

\end_inset


\end_layout

\begin_layout Standard
An example of a hexagonal cavity is shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:overview"

\end_inset

.
 This geometry was adapted from an infinite lattice of period 
\begin_inset Formula $a$
\end_inset

 with air holes of radius 
\begin_inset Formula $0.3a$
\end_inset

.
 A single hole in the middle has a reduced radius 
\begin_inset Formula $0.2a$
\end_inset

 to create a defect in the band gap.
 The dielectric is 
\begin_inset Formula $\varepsilon_{c}=11.56$
\end_inset

 everywhere except in the holes, where there is air.
 A perfectly matched layer (PML) is added to the boundaries to simulate
 the radiation loss, and the axes of the hexagon have been aligned with
 the diagonals rather than the 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 axes because the finite-difference Yee discretization 
\begin_inset CommandInset citation
LatexCommand cite
key "taflove"

\end_inset

 happens to only have mirror symmetry along the diagonals.
 Here, the lasing modes are TE (electric field in-plane and magnetic field
 out of plane), but there is a pair of degenerate threshold modes from the
 hexagon's 
\begin_inset Formula $C_{6\mathrm{v}}$
\end_inset

 symmetry, as shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:overview"

\end_inset

.
 The two are related to each other by linear combinations of sixfold and
 threefold rotations.
 However, these operations do not belong in the 
\begin_inset Formula $C_{4\mathrm{v}}$
\end_inset

 symmetry group of the discretized grid, so the degeneracy here is again
 only approximate.
 For a 
\begin_inset Formula $100\times100$
\end_inset

 finite-difference discretization, there is about a 1.5% splitting between
 the threshold eigenvalues, so again we must use the QP procedure to force
 the threshold degeneracy.
 Since these are TE modes, we now have 
\emph on
two 
\emph default
components of the electric field, and consequently we may treat 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 as a tensor, as in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:tensor_delta_epsilon"

\end_inset

.
 We only consider the diagonal components 
\begin_inset Formula $\delta\varepsilon_{xx}$
\end_inset

 and 
\begin_inset Formula $\delta\varepsilon_{yy}$
\end_inset

 here for simplicity.
 Again, only two iterations of QP are necessary to force the degeneracy
 down to machine precision, and the perturbation used to force the degeneracy
 is shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:phc_deps"

\end_inset

.
 We then use Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:chiral definition"

\end_inset

 as an initial guess for our numerical solver, and the intensity pattern
 of the resulting solution is shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:phc_stable"

\end_inset

.
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename phc/phc_depsxxR.png
	lyxscale 20
	scale 27

\end_inset


\begin_inset Formula $\qquad$
\end_inset


\begin_inset Graphics
	filename phc/phc_depsxxI.png
	lyxscale 20
	scale 27

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Dielectric perturbation obtained from QP procedure for hexagonal cavity.
 Since the mode is TE (
\begin_inset Formula $\mathbf{E}=E_{\mathrm{even}}\hat{\mathbf{x}}+E_{\mathrm{odd}}\hat{\mathbf{y}}$
\end_inset

), we have allowed the perturbation to be a diagonally-anisotropic tensor,
 as in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:tensor_delta_epsilon"

\end_inset

.
 Shown here are the real (left) and imaginary (right) parts of 
\begin_inset Formula $\delta\varepsilon_{xx}$
\end_inset

.
 The 
\begin_inset Formula $\delta\varepsilon_{yy}$
\end_inset

 looks similar except rotated by 60 degrees.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:phc_deps"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centerline{
\end_layout

\end_inset


\begin_inset Graphics
	filename phc/phc_stableIntensity.png
	lyxscale 20
	scale 31

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Intensity pattern for stable lasing mode for hexagonal cavity.
 The pattern appears to be six-fold symmetric, which is expected.
 Unlike in the right panel of Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lowQ_chirality"

\end_inset

 however, the chirality is not significant enough to be visible, since the
 hexagonal cavity is not as lossy as the square cavity in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:lowQ_chirality"

\end_inset

.
 In the ideal system, the second pole 
\begin_inset Formula $\delta\omega^{\prime}$
\end_inset

 stays degenerate with the lasing eigenvalue 
\begin_inset Formula $\delta\omega$
\end_inset

, and this linear combination stays stable for all pump strengths above
 threshold.
 In the discretized system, there is not a true 
\begin_inset Formula $C_{6\mathrm{v}}$
\end_inset

 symmetry, so there is a small splitting similar to that of the even-
\begin_inset Formula $\ell$
\end_inset

 cylinder modes.
 Again, this splitting is too small to affect physically meaningful results
 of the simulation, but can be removed using the QP procedure if desired.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:phc_stable"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Multimode case 
\begin_inset CommandInset label
LatexCommand label
name "sub:multimode discretization method"

\end_inset


\end_layout

\begin_layout Standard
Now we consider how to treat the problem of discretization-broken symmetry
 (Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:discretization_breaking"

\end_inset

) in the case of multimode lasing.
 The method of Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Forcing-the-degeneracy"

\end_inset

 gives a 
\begin_inset Formula $\delta\varepsilon(\mathbf{x})$
\end_inset

 that forces the threshold degeneracy for a 
\emph on
single 
\emph default
mode pair.
 When there are multiple pairs of nearly degenerate modes the generalization
 is straightforward: we allow each pair to have its 
\emph on
own
\emph default
 
\begin_inset Formula $\delta\varepsilon_{\mu}$
\end_inset

, so that their degeneracies can be forced 
\emph on
independently
\emph default
.
 As a result, the dielectric for each pair in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:salt general"

\end_inset

 will become
\begin_inset Formula 
\begin{equation}
\varepsilon_{\mu}(\mathbf{x})=\varepsilon(\mathbf{x})+\delta\varepsilon_{\mu}(\mathbf{x})+\frac{D_{0}(\mathbf{x})\Gamma(\omega_{\mu})}{1+\gamma_{\parallel}^{-1}\sum\left|\Gamma_{\nu}\mathbf{E}_{\nu}(\mathbf{x})\right|^{2}}.
\end{equation}

\end_inset

Since our QP method finds the 
\begin_inset Formula $\delta\varepsilon_{\mu}$
\end_inset

 with the lowest 
\begin_inset Formula $L_{2}$
\end_inset

 norm (as described in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Forcing-the-degeneracy"

\end_inset

) and the splitting decreases with resolution as seen in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:cylinder_resolution"

\end_inset

, each 
\begin_inset Formula $\delta\varepsilon_{\mu}$
\end_inset

 will independently go to zero as we increase the resolution, so this generalize
d method is also 
\emph on
convergent
\emph default
: the unphysical frequency-dependent 
\begin_inset Formula $\delta\varepsilon_{\mu}$
\end_inset

 vanishes with increasing resolution.
\end_layout

\begin_layout Section
Concluding Remarks
\end_layout

\begin_layout Standard
In this paper, we have reduced the problem of identifying the stable lasing
 modes of a degenerate laser from the full nonlinear Maxwell--Bloch equations
 to a small 
\emph on
semi-analytical
\emph default
 solution evaluated in terms of integrals of  the threshold modes (solutions
 to the 
\emph on
linear
\emph default
 Maxwell partial-differential equation).
 Our perturbative solution near threshold confirms an ansatz in the earlier
 degenerate SALT work 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

, in which the circulating and standing wave solutions were guessed as starting
 points for a SALT solver and it was conjectured that the resulting four
 solutions were the only possibilities.
 Furthermore, we have presented an efficient numerical scheme to track these
 solutions far above threshold via numerical SALT solvers 
\begin_inset CommandInset citation
LatexCommand cite
key "direct_salt"

\end_inset

 combined with a simple technique to correct for numerical symmetry breaking.
 And finally, we have shown that the degeneracy of the 
\begin_inset Formula $C_{n}$
\end_inset

 group Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Effects-of-chirality"

\end_inset

 means that circulating lasing modes will retain a degenerate passive pole
 even far above threshold, where the hole-burning term breaks mirror symmetry.
 In addition, our work poses some intriguing open questions for future research.
\end_layout

\begin_layout Standard
First, although we have reduced the question of stability of circulating
 modes near threshold to a simple semi-analytical criterion (checking whether
 a certain integral expression is positive), one would like to additionally
 have a fully analytical proof that the circulating modes are stable, or
 alternatively a counter-example of a 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

-symmetric problem with a degenerate lasing threshold in which the circulating
 mode is unstable.
 (Since Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

 found that circulating modes can become unstable at higher pump strengths,
 one might naively hope that the technique of Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-lige_condensation_arxiv"

\end_inset

 [in which a lasing SALT solution at some pump strength above threshold
 is transformed into a threshold SALT solution by designing the pump profile
 at threshold to match the hole-burning term at the higher pump strength]
 could be used to translate these into an unstable threshold circulating
 mode.
 However, Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-lige_condensation_arxiv"

\end_inset

 only translates one SALT solution into another, and does not translate
 the full Maxwell--Bloch solutions, e.g.
 it is independent of 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

.
 Because the exact Maxwell--Bloch stability eigenvalue 
\begin_inset Formula $\sigma$
\end_inset

 depends on 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

, as explained in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Region-of-validity"

\end_inset

 (only the first-order term 
\begin_inset Formula $\sigma_{1}$
\end_inset

 is independent), and SALT solutions do not, this method of translating
 a hole-burning term to an artificially-designed pump profile at a higher
 threshold does not account for the effects of 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Second, it would be interesting to extend this sort of perturbative SALT/stabili
ty analysis to other lasing systems besides 
\begin_inset Formula $C_{n}$
\end_inset

 and 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetries.
 For example, in a 3d photonic-crystal cavity 
\begin_inset CommandInset citation
LatexCommand cite
key "phc_book"

\end_inset

 one could have cubic symmetry and threefold degeneracies, or one could
 have even greater degeneracies in spherical resonators.
 Alternatively, in a surface-emitting distributed feedback 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-surface_emitting,ref-surface_emitting2,ref-turnbull,ref-distributed_feedback"

\end_inset

 or photonic-crystal laser 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-imada_phc_distributed,ref-continuous_phc_bandedge,ref-ryu_bandedge,ref-coherent_surface_emitting_phc"

\end_inset

, one might have lasing occur at a 
\begin_inset Quotes eld
\end_inset

band edge
\begin_inset Quotes erd
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "yariv"

\end_inset

 in the dispersion relation.
 While a band edge may or may not be degenerate 
\emph on
per se
\emph default
, it coincides with a singularity in the density of states 
\begin_inset CommandInset citation
LatexCommand cite
key "ashcroft-mermin"

\end_inset

 where a continuum of resonances occurs in a small neighborhood of the lasing
 resonance, and perturbative analysis might be very helpful in understanding
 its stability.
 Finally, it would be interesting to apply semi-analytical perturbative
 stability analysis to cases where a small imperfection slightly splits
 the degeneracy, which was studied numerically in Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

.
\end_layout

\begin_layout Section
\start_of_appendix
Degeneracy in 
\begin_inset Formula $C_{n}$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec: degeneracy in Cn"

\end_inset


\end_layout

\begin_layout Standard
We review the result, given in Ref.
 
\begin_inset CommandInset citation
LatexCommand cite
key "dichroism"

\end_inset

, of the fact that there are two-fold degeneracies (due to Lorentz reciprocity)
 in geometries with 
\begin_inset Formula $C_{n}$
\end_inset

 but not 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry, even though there are only one-dimensional irreps.
 We give a slightly simpler and more general proof by exploiting the differentia
l form of Maxwell's equations, as opposed to the integral form in Ref.
 
\begin_inset CommandInset citation
LatexCommand cite
key "dichroism"

\end_inset

.
 
\end_layout

\begin_layout Standard
Consider a field 
\begin_inset Formula $\mathbf{E}^{+}$
\end_inset

 that satisfies the equation 
\begin_inset Formula $\hat{L}(\omega^{+})\mathbf{E}^{+}=0$
\end_inset

, where we define the linear operator (as in Ref.
 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-adi"

\end_inset

)
\begin_inset Formula 
\begin{equation}
\hat{L}(\omega)\equiv-\nabla\times\frac{1}{\mu(\mathbf{x},\omega)}\nabla\times+\,\omega^{2}\varepsilon(\mathbf{x},\omega)
\end{equation}

\end_inset

where 
\begin_inset Formula $\omega$
\end_inset

 is the eigenfrequency and 
\begin_inset Formula $\varepsilon$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 have 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry: that is, 
\begin_inset Formula $R_{n}\varepsilon R_{n}^{-1}=\varepsilon$
\end_inset

, where 
\begin_inset Formula $R_{n}$
\end_inset

 is an 
\begin_inset Formula $n$
\end_inset

-fold rotation and 
\begin_inset Formula $R_{n}^{n}=1$
\end_inset

, the identity operator.
 Suppose that the field transforms like one of the chiral irreps of 
\begin_inset Formula $C_{n}$
\end_inset

: that is, 
\begin_inset Formula $R_{n}\mathbf{E}^{+}=\exp\left(-\frac{2\pi im}{n}\right)\mathbf{E}^{+}$
\end_inset

, with 
\begin_inset Formula $0<\left|m\right|\leq\mathrm{floor}(\frac{n-1}{2})$
\end_inset

.
 We want to show that there exists some other function 
\begin_inset Formula $\mathbf{E}^{-}$
\end_inset

 that transforms according to the irrep of the opposite chirality 
\emph on
and 
\emph default
has the same eigenfrequency: that is, 
\begin_inset Formula $R_{n}\mathbf{E}^{-}=\exp\left(\frac{2\pi im}{n}\right)\mathbf{E}^{-}$
\end_inset

 and 
\begin_inset Formula $\hat{L}(\omega^{+})\mathbf{E}^{-}=0$
\end_inset

.
 
\end_layout

\begin_layout Standard
The key step is to use the right basis: we 
\emph on
could 
\emph default
find the Maxwell eigenfrequencies (Green's-function poles) by solving the
 nonlinear (in 
\begin_inset Formula $\omega$
\end_inset

) eigenvalue problem 
\begin_inset Formula $\hat{L}(\omega)\mathbf{E}=0$
\end_inset

.
 However, these make a poor basis because they diagonalize 
\emph on
different 
\emph default
operators 
\begin_inset Formula $\hat{L}(\omega)$
\end_inset

 with 
\begin_inset Formula $\omega\neq\omega^{+}$
\end_inset

.
 Instead, we fix 
\begin_inset Formula $\omega=\omega^{+}$
\end_inset

 and examine the set of eigenfunctions 
\begin_inset Formula $\mathbf{E}_{j}^{-}$
\end_inset

 that satisfy 
\begin_inset Formula $\hat{L}(\omega^{+})\mathbf{E}_{j}^{-}=\lambda_{j}\mathbf{E}_{j}^{-}$
\end_inset

 and that transform as the 
\begin_inset Formula $\exp\left(\frac{2\pi im}{n}\right)$
\end_inset

 irrep.
 A similar strategy was employed in Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ge_steady-state_2010"

\end_inset

 to introduce the threshold constant-flux (TCF) states basis.
 (The TCF approach is slightly different, for it assumes that the eigenvalues
 
\begin_inset Formula $\lambda_{j}$
\end_inset

 are followed by a spatial function that specifies the pump profile.) Note
 that 
\begin_inset Formula $\lambda_{j}$
\end_inset

 are 
\emph on
not 
\emph default
squared eigenfrequencies and 
\begin_inset Formula $\mathbf{E}_{j}^{-}$
\end_inset

 are 
\emph on
not 
\emph default
Maxwell solutions, except for 
\begin_inset Formula $\lambda_{j}=0$
\end_inset

.
 Because this set is a complete basis for functions of this chirality, the
 function 
\begin_inset Formula $(\mathbf{E}^{+})^{\star}$
\end_inset

 (which transforms in the same way as 
\begin_inset Formula $\mathbf{E}_{j}^{-}$
\end_inset

 because the rotation operator 
\begin_inset Formula $R_{n}$
\end_inset

 is real) can be expanded in this basis:
\begin_inset Formula 
\begin{equation}
\left(\mathbf{E}^{+}\right)^{\star}=\sum b_{j}\mathbf{E}_{j}^{-},
\end{equation}

\end_inset

assuming that 
\begin_inset Formula $\hat{L}(\omega^{+})$
\end_inset

 is diagonalizable (which is generically true for matrices except at exceptional
 points; the situation for infinite-dimensional operators is more complicated,
 but diagonalizability is typically assumed there too in physics).
 We will now show that at least 
\emph on
one 
\emph default
of these 
\begin_inset Formula $\mathbf{E}_{j}^{-}$
\end_inset

 is exactly the 
\begin_inset Formula $\mathbf{E}^{-}$
\end_inset

 satisfying 
\begin_inset Formula $\hat{L}(\omega^{+})\mathbf{E}^{-}=0$
\end_inset

 that we are looking for.
\end_layout

\begin_layout Standard
First, we define the 
\emph on
unconjugated 
\emph default
inner product 
\begin_inset Formula $\left(\mathbf{f},\mathbf{g}\right)\equiv\int d^{3}x\,\mathbf{f}\cdot\mathbf{g}$
\end_inset

.
 Then, for appropriate boundary conditions, 
\begin_inset Formula $\hat{L}(\omega^{+})$
\end_inset

 is complex symmetric, that is: 
\begin_inset Formula $\left(\mathbf{f},\hat{L}\mathbf{g}\right)=\left(\hat{L}\mathbf{f},\mathbf{g}\right)$
\end_inset

 for reciprocal materials 
\begin_inset Formula $\varepsilon=\varepsilon^{T}$
\end_inset

, 
\begin_inset Formula $\mu=\mu^{T}$
\end_inset

, and this is known as Lorentz reciprocity 
\begin_inset CommandInset citation
LatexCommand cite
key "phc_book"

\end_inset

.
 Because 
\begin_inset Formula $\hat{L}(\omega^{+})$
\end_inset

 is complex symmetric, its eigenfunctions with distinct eigenvalues are
 orthogonal; that is: 
\begin_inset Formula $\left(\mathbf{E}_{i}^{-},\mathbf{E}_{j}^{-}\right)=0$
\end_inset

 for 
\begin_inset Formula $\lambda_{i}\neq\lambda_{j}$
\end_inset

.
 Now write
\begin_inset Formula 
\begin{align}
\int d^{3}x\,\left|\mathbf{E}^{+}\right|^{2} & =\sum b_{j}\left(\mathbf{E}^{+},\mathbf{E}_{j}^{-}\right).
\end{align}

\end_inset

If all 
\begin_inset Formula $\mathbf{E}_{j}^{-}$
\end_inset

 had 
\begin_inset Formula $\lambda_{j}\neq0$
\end_inset

, then 
\begin_inset Formula $\left(\mathbf{E}^{+}\cdot\mathbf{E}_{j}^{-}\right)=0$
\end_inset

 for all 
\begin_inset Formula $j$
\end_inset

.
 However, the left-hand side is obviously positive, so at least one term
 in the sum on the right-hand side must be non-vanishing.
 Hence, this term has the eigenvalue 
\begin_inset Formula $\lambda_{j}=0$
\end_inset

, and it is precisely the 
\begin_inset Formula $\mathbf{E}^{-}$
\end_inset

 that is degenerate to 
\begin_inset Formula $\mathbf{E}^{+}$
\end_inset

.
 
\end_layout

\begin_layout Section
Allowed lasing modes
\begin_inset CommandInset label
LatexCommand label
name "sec: appendix allowed lasing modes"

\end_inset


\end_layout

\begin_layout Standard
In this appendix, we show that the only allowed lasing modes for 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 geometries above threshold are the circulating modes 
\begin_inset Formula $\mathbf{E}_{\pm}$
\end_inset

 and standing-wave modes 
\begin_inset Formula $\mathbf{E}_{+}+e^{i\theta}\mathbf{E}_{-}$
\end_inset

, with 
\begin_inset Formula $\theta$
\end_inset

 an arbitrary angle for 
\begin_inset Formula $n\neq4\ell$
\end_inset

 (where 
\begin_inset Formula $\ell$
\end_inset

 is the order of the 2d irrep that the degenerate modes transform as), and
 
\begin_inset Formula $\theta$
\end_inset

 an integer multiple of 
\begin_inset Formula $\frac{\pi}{2}$
\end_inset

 for 
\begin_inset Formula $n=4\ell$
\end_inset

.
 We begin by writing 
\begin_inset Formula $D_{0}=D_{\mathrm{t}}(1+d)$
\end_inset

 and inserting into Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:single-mode-salt"

\end_inset

.
 We expand to lowest order in 
\begin_inset Formula $d$
\end_inset

 and the mode intensity, and we have
\begin_inset Formula 
\begin{equation}
\nabla\times\nabla\times\mathbf{E}=\omega^{2}\left[\varepsilon+D_{\mathrm{t}}\Gamma\left(1+d-\gamma_{\parallel}^{-1}\left|\Gamma\mathbf{E}\right|^{2}\right)\right]\mathbf{E}.\label{eq:expanded salt}
\end{equation}

\end_inset

Comparing with Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:threshold salt"

\end_inset

 at threshold, we conclude that 
\begin_inset Formula $\mathbf{E}=\mathcal{O}(\sqrt{d})$
\end_inset

, and that the profile should be some linear combination of the threshold
 modes 
\begin_inset Formula $\mathbf{E}_{1,2}$
\end_inset

, as in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:lasing_ansatz"

\end_inset

.
 Inserting Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:lasing_ansatz"

\end_inset

 into Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:expanded salt"

\end_inset

, noting that the zeroth-order terms vanish due to Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:threshold salt"

\end_inset

, we obtain
\begin_inset Formula 
\begin{multline}
\left[\nabla\times\nabla\times-\:\omega_{\mathrm{t}}^{2}\left(\varepsilon+D_{\mathrm{t}}\Gamma_{\mathrm{t}}\right)\right]\delta\mathbf{E}\\
=\left\{ \omega_{1}\frac{\partial}{\partial\omega_{\mathrm{t}}}\left[\omega_{\mathrm{t}}^{2}\left(\varepsilon+D_{\mathrm{t}}\Gamma_{\mathrm{t}}\right)\right]+\omega_{\mathrm{t}}^{2}D_{\mathrm{t}}\Gamma_{\mathrm{t}}\left(1-\left|\mathbf{f}\right|^{2}\right)\right\} \mathbf{f}
\end{multline}

\end_inset

where 
\begin_inset Formula $\mathbf{f}\equiv a_{1}\mathbf{E}_{1}+a_{2}\mathbf{E}_{2}$
\end_inset

.
 Now multiply by 
\begin_inset Formula $\mathbf{E}_{1,2}$
\end_inset

 and integrate over all space, and we obtain Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:a eigenproblem"

\end_inset

, where we have used the fact that 
\begin_inset Formula 
\begin{equation}
\int d^{3}x\,\mathbf{E}_{1,2}\cdot\left[\nabla\times\nabla\times-\:\omega_{\mathrm{t}}^{2}\left(\varepsilon+D_{\mathrm{t}}\Gamma_{\mathrm{t}}\right)\right]\delta\mathbf{E}=0
\end{equation}

\end_inset

because the threshold Maxwell operator is complex-symmetric 
\begin_inset CommandInset citation
LatexCommand cite
key "moiseyev,siegman,phc_book"

\end_inset

 so that it acts to the left and annihilates 
\begin_inset Formula $\mathbf{E}_{1,2}$
\end_inset

.
 (The fact that the 
\begin_inset Formula $\nabla\times\nabla\times$
\end_inset

 operator acts to the left can be understood using integration by parts,
 with the boundary terms vanishing due to the limiting-absorption principle
 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-limiting-absorption"

\end_inset

.) Now, choose 
\begin_inset Formula $\mathbf{E}_{1}=\mathbf{E}_{+}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{2}=\mathbf{E}_{-}$
\end_inset

, where 
\begin_inset Formula $\mathbf{E}_{\pm}$
\end_inset

 is defined in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:chiral definition"

\end_inset

.
 For generality, we assume that the geometry [i.e.
 the functions 
\begin_inset Formula $\varepsilon(\mathbf{x})$
\end_inset

 and 
\begin_inset Formula $D_{\mathrm{t}}(\mathbf{x})$
\end_inset

] has at least 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry.
 In Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:a eigenproblem"

\end_inset

, we see that 
\begin_inset Formula $\int d^{3}x\varepsilon(\mathbf{x})\mathbf{E}_{+}\cdot\mathbf{E}_{+}$
\end_inset

 vanishes, because it is the conjugated inner product of 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{+}^{\star}$
\end_inset

, which transform as the clockwise and counterclockwise 1d irreps in the
 
\begin_inset Formula $C_{n}$
\end_inset

 group, and from the great orthogonality theorem 
\begin_inset CommandInset citation
LatexCommand cite
key "inui_group,tinkham"

\end_inset

, conjugated inner products between functions belonging to different irreps
 always vanish [e.g.
 for circulating modes on a uniform ring, the integral 
\begin_inset Formula $\int d\phi\,e^{i\ell\phi}(e^{-i\ell\phi})^{\star}$
\end_inset

 vanishes].
 Also, the integral over 
\begin_inset Formula $D_{\mathrm{t}}(\mathbf{x})$
\end_inset

 is the same, because it also has at least 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry.
 Excluding the intensity term in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:a eigenproblem"

\end_inset

, the rest of the terms become
\begin_inset Formula 
\begin{equation}
a_{\mp}\left(\omega_{1}H+G_{D}\right),
\end{equation}

\end_inset

where we have defined
\begin_inset Formula 
\begin{align}
G_{\varepsilon} & \equiv\int d^{3}x\,\varepsilon(\mathbf{x})\mathbf{E}_{+}\cdot\mathbf{E}_{-}\nonumber \\
G_{D} & \equiv\int d^{3}x\,D_{\mathrm{t}}(\mathbf{x})\mathbf{E}_{+}\cdot\mathbf{E}_{-}.\label{eq:G and H definitions}\\
H & \equiv(\omega_{\mathrm{t}}^{2}\Gamma_{\mathrm{t}})^{-1}\frac{\partial}{\partial\omega_{\mathrm{t}}}\left\{ \omega_{\mathrm{t}}^{2}\left(G_{\varepsilon}+G_{D}\Gamma_{\mathrm{t}}\right)\right\} .\nonumber 
\end{align}

\end_inset

For the intensity term, we have 
\begin_inset Formula $\int d^{3}x\,D_{\mathrm{t}}\mathbf{E}_{\pm}\cdot\mathbf{f}\left|\mathbf{f}\right|^{2}$
\end_inset

.
 We note that the quantities 
\begin_inset Formula $\left|\mathbf{E}_{\pm}\right|^{2}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{+}\cdot\mathbf{E}_{-}$
\end_inset

 have 
\begin_inset Formula $C_{n}$
\end_inset

 symmetry, so by symmetry arguments, the only surviving integrals are
\begin_inset Formula 
\begin{align}
I_{\pm} & =\int d^{3}x\,D_{\mathrm{t}}\left|\vec{E}_{\pm}\right|^{2}\vec{E}_{+}\cdot\vec{E}_{-}\nonumber \\
J_{\pm} & =\int d^{3}x\,D_{\mathrm{t}}(\vec{E}_{\pm}^{\star}\cdot\vec{E}_{\mp})\vec{E}_{\pm}\cdot\vec{E}_{\pm}\label{eq:I J K definitions}\\
K_{\pm} & =\int d^{3}x\,D_{\mathrm{t}}(\vec{E}_{\mp}^{\star}\cdot\vec{E}_{\pm})\vec{E}_{\pm}\cdot\vec{E}_{\pm}.\nonumber 
\end{align}

\end_inset

Additionally, note that for 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

, we have 
\begin_inset Formula $I_{+}=I_{-}$
\end_inset

, and the same for 
\begin_inset Formula $J$
\end_inset

 and 
\begin_inset Formula $K$
\end_inset

.
 Further, for TM modes (
\begin_inset Formula $\mathbf{E}_{\pm}=E_{\pm}\hat{\mathbf{z}}$
\end_inset

), we have 
\begin_inset Formula $I_{\pm}=J_{\pm}$
\end_inset

.
 Finally, 
\begin_inset Formula $K_{\pm}$
\end_inset

 is only non-vanishing for 
\begin_inset Formula $n=4\ell$
\end_inset

, since in that special case, 
\begin_inset Formula $\mathbf{E}_{+}$
\end_inset

 picks up a factor of 
\begin_inset Formula $i$
\end_inset

 under four-fold rotation, as seen in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:chiral definition"

\end_inset

.
 With these definitions, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:a eigenproblem"

\end_inset

 straightforwardly reduces to Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:reduced a plus minus"

\end_inset

.
\end_layout

\begin_layout Standard
To solve for the coefficients 
\begin_inset Formula $a_{\pm}$
\end_inset

 and the frequency shift 
\begin_inset Formula $\omega_{1}$
\end_inset

, first consider the case 
\begin_inset Formula $a_{-}=0$
\end_inset

.
 Dividing Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:reduced a plus minus"

\end_inset

 (with the bottom sign) by 
\begin_inset Formula $a_{+}$
\end_inset

 then yields
\begin_inset Formula 
\begin{equation}
\left|a_{+}\right|^{2}=\frac{\omega_{1}H+G_{D}}{I_{+}}.
\end{equation}

\end_inset

Taking the imaginary part of both sides, and noting that 
\begin_inset Formula $\omega_{1}$
\end_inset

 is real, we obtain
\begin_inset Formula 
\begin{equation}
0=\omega_{1}\Im\left(\frac{H}{I_{+}}\right)+\Im\left(\frac{G_{D}}{I_{+}}\right),\label{eq:imaginary part of |a|^2}
\end{equation}

\end_inset

which leads to the circulating solution.
 (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:circulating lasing"

\end_inset

 holds for 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

; the same expression with 
\begin_inset Formula $I$
\end_inset

 replaced by 
\begin_inset Formula $I_{\pm}$
\end_inset

 also holds for 
\begin_inset Formula $C_{n}$
\end_inset

.
 In this case 
\begin_inset Formula $I_{+}\neq I_{-}$
\end_inset

, so the two circulating lasing modes will actually have slightly different
 amplitudes and frequencies.) Note that the fact that 
\begin_inset Formula $\left|a_{+}\right|^{2}$
\end_inset

 must be a positive number also gives a cutoff condition
\begin_inset Formula 
\begin{equation}
\Re(G_{D}/I_{\pm})>\frac{\Im\left(G_{D}/I_{\pm}\right)}{\Im\left(H/I_{\pm}\right)}\Re(H/I_{\pm}).
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Next, we consider the case that both 
\begin_inset Formula $a_{\pm}$
\end_inset

 are nonzero.
 Write 
\begin_inset Formula $a_{\pm}=\left|a_{\pm}\right|e^{i\theta_{\pm}}$
\end_inset

 and define the relative phase 
\begin_inset Formula $z=e^{i(\theta_{-}-\theta_{+})}$
\end_inset

.
 Divide Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:reduced a plus minus"

\end_inset

 by 
\begin_inset Formula $a_{\mp}$
\end_inset

, and we obtain
\begin_inset Formula 
\begin{equation}
\left|a_{\mp}\right|^{2}I_{\mp}+\left|a_{\pm}\right|^{2}\left(I_{\pm}+J_{\pm}+z^{\mp2}K_{\pm}\right)=\omega_{1}H+G_{D}.
\end{equation}

\end_inset

Solving this linear equation for the unknowns 
\begin_inset Formula $\left|a_{\pm}\right|^{2}$
\end_inset

, we obtain
\begin_inset Formula 
\begin{equation}
\left|a_{\pm}\right|^{2}=(\omega_{1}H+G_{D})T_{\pm},
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
T_{\pm}=\frac{J_{\mp}+z^{\pm2}K_{\mp}}{\left(I_{+}+J_{+}+z^{-2}K_{+}\right)\left(I_{-}+J_{-}+z^{2}K_{-}\right)-I_{+}I_{-}}.
\end{equation}

\end_inset

Again, since 
\begin_inset Formula $\left|a_{\pm}\right|^{2}$
\end_inset

 and 
\begin_inset Formula $\omega_{1}$
\end_inset

 are real, we have
\begin_inset Formula 
\begin{equation}
\omega_{1}=-\frac{\Im\left(G_{D}T_{+}\right)}{\Im\left(HT_{+}\right)}=-\frac{\Im\left(G_{D}T_{-}\right)}{\Im\left(HT_{-}\right)}.\label{eq:omega1 constraint}
\end{equation}

\end_inset

The second equality here is a constraint that must be satisfied.
 For 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 with 
\begin_inset Formula $n\neq4\ell$
\end_inset

, we have 
\begin_inset Formula $I_{+},J_{+}=I_{-},J_{-}$
\end_inset

 and 
\begin_inset Formula $K_{\pm}=0$
\end_inset

 (as explained previously), so 
\begin_inset Formula $T_{+}=T_{-}$
\end_inset

 and the constraint is automatically satisfied, indicating that 
\begin_inset Formula $z$
\end_inset

 is free to have any phase, and yielding the solution in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:n != 4 lasing"

\end_inset

.
 For 
\begin_inset Formula $C_{n}$
\end_inset

 with 
\begin_inset Formula $n\neq4\ell$
\end_inset

, we again have 
\begin_inset Formula $K_{\pm}=0$
\end_inset

, but there is no mirror symmetry so 
\begin_inset Formula $I_{+},J_{+}\neq I_{-},J_{-}$
\end_inset

, and no choice of 
\begin_inset Formula $z$
\end_inset

 will allow Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:omega1 constraint"

\end_inset

 to be satisfied.
 Hence, there are no standing lasing modes for this case.
\end_layout

\begin_layout Standard
For 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 with 
\begin_inset Formula $n=4\ell$
\end_inset

, we again have 
\begin_inset Formula $I_{+},J_{+}=I_{-},J_{-}$
\end_inset

, but we also have 
\begin_inset Formula $K_{+}=K_{-}\neq0$
\end_inset

.
 Hence, for 
\begin_inset Formula $T_{+}=T_{-}$
\end_inset

 to be true, we must have 
\begin_inset Formula $z^{2}=z^{-2}=\pm1$
\end_inset

.
 Hence, there are two cases, 
\begin_inset Formula $z=\pm1$
\end_inset

, for which the solution is given in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:E+ + E- lasing"

\end_inset

, and 
\begin_inset Formula $z=\pm i$
\end_inset

, for which the solution is given in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:E+ + i E- lasing"

\end_inset

.
 For 
\begin_inset Formula $C_{n}$
\end_inset

 with 
\begin_inset Formula $n=4\ell$
\end_inset

, we now have 
\begin_inset Formula $I_{+},J_{+}\neq I_{-},J_{-}$
\end_inset

, and 
\begin_inset Formula $K_{+}\neq K_{-}$
\end_inset

, with both 
\begin_inset Formula $K_{\pm}$
\end_inset

 nonzero.
 Empirically, we have found that Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:omega1 constraint"

\end_inset

 still has solutions (which must obtained by solving the equation numerically)
 at four allowed phases 
\begin_inset Formula $z$
\end_inset

, with angles separated by 
\begin_inset Formula $\frac{\pi}{2}$
\end_inset

, just as in the 
\begin_inset Formula $C_{4\ell\mathrm{v}}$
\end_inset

 case.
 Of course, it is straightforward to choose the overall normalization and
 phase of the threshold basis 
\begin_inset Formula $\mathbf{E}_{\pm}$
\end_inset

 such that the standing modes are still 
\begin_inset Formula $\mathbf{E}_{+}\pm\mathbf{E}_{-}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{+}\pm i\mathbf{E}_{-}$
\end_inset

, just as in the 
\begin_inset Formula $C_{4\ell\mathrm{v}}$
\end_inset

 case.
\end_layout

\begin_layout Section
Stability calculations
\begin_inset CommandInset label
LatexCommand label
name "sec: appendix stability calculations"

\end_inset


\end_layout

\begin_layout Standard
In this appendix, we provide details for the derivation of the stability
 eigenvalues given in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Stability-analysis summary"

\end_inset

.
 Comparing Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:delta"

\end_inset

 and Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:time-dependent quadratic"

\end_inset

, we see that the matrices are
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathsf{A}=\left(\begin{array}{ccccc}
\Delta & -\varepsilon_{\mathrm{I}}\omega^{2} & \omega^{2} & 0 & 0\\
\varepsilon_{\mathrm{I}}\omega^{2} & \Delta & 0 & \omega^{2} & 0\\
\gamma_{\perp}D & 0 & \omega_{a}-\omega & \gamma_{\perp} & \gamma_{\perp}\mathbf{E}_{\mathrm{R}}\\
0 & \gamma_{\perp}D & -\gamma_{\perp} & \omega_{a}-\omega & \gamma_{\perp}\mathbf{E}_{\mathrm{I}}\\
-\mathbf{P}_{\mathrm{I}} & \mathbf{P}_{\mathrm{R}} & \mathbf{E}_{\mathrm{I}} & -\mathbf{E}_{\mathrm{R}} & \gamma_{\parallel}
\end{array}\right),\label{eq:A matrix}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Delta=\varepsilon_{\mathrm{R}}\omega^{2}-\nabla\times\nabla\times$
\end_inset

, 
\begin_inset Formula $\mathbf{E}_{\mathrm{R}}\equiv\Re(\mathbf{E})$
\end_inset

, and 
\begin_inset Formula $\mathbf{E}_{\mathrm{I}}\equiv\Im(\mathbf{E})$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\mathsf{B}=\left(\begin{array}{ccccc}
-2\varepsilon_{\mathrm{I}}\omega & -2\varepsilon_{\mathrm{R}}\omega & 0 & -2\omega & 0\\
2\varepsilon_{\mathrm{R}}\omega & -2\varepsilon_{\mathrm{I}}\omega & 2\omega & 0 & 0\\
0 & 0 & 0 & 1 & 0\\
0 & 0 & -1 & 0 & 0\\
0 & 0 & 0 & 0 & 1
\end{array}\right),
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\mathsf{C}=\left(\begin{array}{ccccc}
-\varepsilon_{\mathrm{R}} & \varepsilon_{\mathrm{I}} & -1 & 0 & 0\\
-\varepsilon_{\mathrm{I}} & -\varepsilon_{\mathrm{R}} & 0 & -1 & 0\\
0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0
\end{array}\right).
\end{equation}

\end_inset

We expand the matrices in powers of 
\begin_inset Formula $\sqrt{d}$
\end_inset

, as in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:matrix expansion"

\end_inset

, by noting that 
\begin_inset Formula $\omega=\omega_{\mathrm{t}}+\omega_{1}d+\mathcal{O}(d^{2})$
\end_inset

, 
\begin_inset Formula $D_{0}=D_{\mathrm{t}}(1+d)$
\end_inset

, and 
\begin_inset Formula $\mathbf{E},\mathbf{P}=\mathcal{O}(\sqrt{d})$
\end_inset

, according to Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:lasing_ansatz"

\end_inset

.
 Now expand Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:quadratic eigenproblem"

\end_inset

 and keep track of terms order-by-order using Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:eigenpair expansion"

\end_inset

.
 
\end_layout

\begin_layout Subsection
Zeroth and lowest (
\begin_inset Formula $d^{1/2}$
\end_inset

) orders
\end_layout

\begin_layout Standard
At zeroth order, we have
\begin_inset Formula 
\begin{equation}
\left(\mathsf{C}\sigma_{0}^{2}+\mathsf{B}_{0}\sigma_{0}+\mathsf{A}_{0}\right)\mathsf{x}_{0}=0,\label{eq:zeroth order quadratic}
\end{equation}

\end_inset

which turns out to be equivalent to the SALT equation at threshold, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:threshold salt"

\end_inset

.
 The solution is easily seen to be any linear combination of the threshold
 modes (with the associated polarizations), given in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:vk definition"

\end_inset

.
 Because these modes already solve the SALT equation, they necessarily have
 
\begin_inset Formula $\sigma_{0}=0$
\end_inset

 (there are other solutions to Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:zeroth order quadratic"

\end_inset

, corresponding to the below-threshold modes.
 However, by definition, they are stable, so we are not concerned with them).
 Note that there are now four linearly-independent eigenvectors (from Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:vk definition"

\end_inset

), even though we only have a double degeneracy in the threshold modes.
 This is because we have separated the problem into real and imaginary parts,
 and this separation will become significant at higher orders in 
\begin_inset Formula $\sqrt{d}$
\end_inset

, when the non-analyticity appears in the equations.
\end_layout

\begin_layout Standard
Inserting these results into Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:quadratic eigenproblem"

\end_inset

 at order 
\begin_inset Formula $\sqrt{d}$
\end_inset

, we have
\begin_inset Formula 
\begin{equation}
(\mathsf{B}_{0}\sigma_{1/2}+\mathsf{A}_{1/2})\sum b_{k}\mathsf{v}_{k}+\mathsf{A}_{0}\mathsf{x}_{1/2}=0.\label{eq:half order quadratic}
\end{equation}

\end_inset

We now define the vectors
\begin_inset Formula 
\begin{equation}
\mathsf{w}_{j}=\left(\begin{array}{c}
\Re\vec{e}_{j}\\
-\Im\vec{e}_{j}\\
\omega_{\mathrm{t}}^{2}\Re\left(\vec{e}_{j}\Gamma_{\mathrm{t}}\right)/\gamma_{\perp}\\
-\omega_{\mathrm{t}}^{2}\Im\left(\vec{e}_{j}\Gamma_{\mathrm{t}}\right)/\gamma_{\perp}\\
0
\end{array}\right).
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{e}_{k}$
\end_inset

 forms the four-component complex basis defined in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:vk definition"

\end_inset

.
 It is straightforward to show that 
\begin_inset Formula $\mathsf{A}_{0}^{T}\mathsf{w}_{j}=0$
\end_inset

.
 Additionally, due to the nonzero pattern of 
\begin_inset Formula $\mathsf{A}_{1/2}$
\end_inset

, it is easy to see that 
\begin_inset Formula $\mathsf{A}_{1/2}\mathsf{v}_{k}$
\end_inset

 has all zero elements except the last, and hence 
\begin_inset Formula $\mathsf{w}_{j}^{T}\mathsf{A}_{1/2}\mathsf{v}_{k}=0$
\end_inset

.
 Acting on Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:half order quadratic"

\end_inset

 with 
\begin_inset Formula $\mathsf{w}_{j}^{T}$
\end_inset

, we then obtain 
\begin_inset Formula $\sigma_{1/2}\sum\left(\mathsf{w}_{j}^{T}\mathsf{B}_{0}\mathsf{v}_{k}\right)b_{k}=0$
\end_inset

.
 The matrix 
\begin_inset Formula $\mathsf{w}_{j}^{T}\mathsf{B}_{0}\mathsf{v}_{k}$
\end_inset

 is nonsingular, which we will see later after we explicitly compute it
 in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:B0 element final"

\end_inset

.
 Hence, we conclude that 
\begin_inset Formula $\sigma_{1/2}=0$
\end_inset

.
 
\end_layout

\begin_layout Standard
Next, we compute 
\begin_inset Formula $\mathsf{A}_{1/2}\mathsf{v}_{k}$
\end_inset

.
 Since the only nonzero element of 
\begin_inset Formula $\mathsf{A}_{1/2}\mathsf{v}_{k}$
\end_inset

 is the last, we define this element, after straightforward evaluation,
 as 
\begin_inset Formula 
\begin{equation}
g_{k}\equiv2D_{\mathrm{t}}\left|\Gamma_{\mathrm{t}}\right|\sqrt{\gamma_{\parallel}}\Re\left[\vec{e}_{k}^{\star}\cdot(a_{+}\vec{E}_{+}+a_{-}\vec{E}_{-})\right].
\end{equation}

\end_inset

Inserting the result 
\begin_inset Formula $\sigma_{1/2}=0$
\end_inset

 into Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:half order quadratic"

\end_inset

, we obtain
\begin_inset Formula 
\begin{equation}
\mathsf{A}_{0}\mathsf{x}_{1/2}=-\mathsf{A}_{1/2}\sum b_{k}\mathsf{v}_{k}=\left(\begin{array}{c}
0\\
0\\
0\\
0\\
-\sum b_{k}g_{k}
\end{array}\right).
\end{equation}

\end_inset

The vector 
\begin_inset Formula $\mathsf{x}_{1/2}$
\end_inset

 must also have this same nonzero pattern, because if it had any nonzero
 elements in the first four, they must be annihilated by 
\begin_inset Formula $\mathsf{A}_{0}$
\end_inset

 and hence must be some linear combination of 
\begin_inset Formula $\mathsf{v}_{k}$
\end_inset

 (which is already accounted for in 
\begin_inset Formula $\mathsf{x}_{0}$
\end_inset

 and would be redundant).
 Hence, we immediately conclude by inspection of 
\begin_inset Formula $\mathsf{A}_{0}$
\end_inset

 that
\begin_inset Formula 
\begin{equation}
\mathsf{x}_{1/2}=\left(\begin{array}{c}
0\\
0\\
0\\
0\\
-\gamma_{\parallel}^{-1}\sum b_{k}g_{k}
\end{array}\right).\label{eq:x1/2 exact}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
First order
\end_layout

\begin_layout Standard
At the next order, 
\begin_inset Formula $\mathcal{O}(d)$
\end_inset

, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:quadratic eigenproblem"

\end_inset

 is
\begin_inset Formula 
\begin{equation}
(\mathsf{B}_{0}\sigma_{1}+\mathsf{A}_{1})\sum b_{k}\mathsf{v}_{k}+\mathsf{A}_{1/2}\mathsf{x}_{1/2}+\mathsf{A}_{0}\mathsf{x}_{1}=0.\label{eq:first order quadratic}
\end{equation}

\end_inset

(Note that without the 
\begin_inset Formula $\mathsf{A}_{1/2}\mathsf{x}_{1/2}$
\end_inset

 term, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:first order quadratic"

\end_inset

 would yield identical results to finding the two passive poles of the SALT
 equation that come from the threshold degenerate lasing modes.) Again, act
 on this equation with 
\begin_inset Formula $\mathsf{w}_{j}^{T}$
\end_inset

.
 By direct evaluation, we have
\begin_inset Formula 
\begin{multline}
\mathsf{w}_{j}^{T}\mathsf{A}_{1}\mathsf{v}_{k}=\Re\left[\omega_{1}\frac{\partial}{\partial\omega_{\mathrm{t}}}\omega_{\mathrm{t}}^{2}\int d^{3}x\,\vec{e}_{j}\cdot(\varepsilon+\Gamma_{\mathrm{t}}D_{\mathrm{t}})\vec{e}_{k}\right]+\\
\Re\left[\omega_{\mathrm{t}}^{2}\Gamma_{\mathrm{t}}\int d^{3}x\,D_{\mathrm{t}}\vec{e}_{j}\cdot\left(1-\left|\vec{f}\right|^{2}\right)\vec{e}_{k}\right]
\end{multline}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\mathsf{w}_{j}^{T}\mathsf{B}_{0}\mathsf{v}_{k}=-\Im\left[\frac{\partial}{\partial\omega_{\mathrm{t}}}\omega_{\mathrm{t}}^{2}\int d^{3}x\,\vec{e}_{j}\cdot(\varepsilon+\Gamma_{\mathrm{t}}D_{\mathrm{t}})\vec{e}_{k}\right].
\end{equation}

\end_inset

 By the same symmetry arguments used to evaluate the integrals in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix allowed lasing modes"

\end_inset

, it is straightforward to show that 
\begin_inset Formula 
\begin{equation}
\frac{\partial}{\partial\omega_{\mathrm{t}}}\omega_{\mathrm{t}}^{2}\int d^{3}x\,\vec{e}_{j}\cdot(\varepsilon+\Gamma_{\mathrm{t}}D_{\mathrm{t}})\vec{e}_{k}=\omega_{\mathrm{t}}^{2}\Gamma_{\mathrm{t}}H\left(\begin{array}{cc}
\mathsf{X} & i\mathsf{X}\\
i\mathsf{X} & -\mathsf{X}
\end{array}\right)_{jk},
\end{equation}

\end_inset

where 
\begin_inset Formula $H$
\end_inset

 is given in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:G and H definitions"

\end_inset

 and
\begin_inset Formula 
\begin{equation}
\mathsf{X}\equiv\left(\begin{array}{cc}
0 & 1\\
1 & 0
\end{array}\right).
\end{equation}

\end_inset

Next, we have
\begin_inset Formula 
\begin{multline}
\int d^{3}x\,D_{\mathrm{t}}\vec{e}_{j}\cdot\left|\vec{f}\right|^{2}\vec{e}_{k}=\left(\begin{array}{cc}
\mathsf{M} & i\mathsf{M}\\
i\mathsf{M} & -\mathsf{M}
\end{array}\right)_{jk}+\\
\left(\left|a_{+}\right|^{2}I_{+}+\left|a_{-}\right|^{2}I_{-}\right)\left(\begin{array}{cc}
\mathsf{X} & i\mathsf{X}\\
i\mathsf{X} & -\mathsf{X}
\end{array}\right)_{jk}
\end{multline}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathsf{M}\equiv\left(\begin{array}{cc}
a_{+}^{\star}a_{-}J_{+}+a_{+}a_{-}^{\star}K_{+} & 0\\
0 & a_{+}^{\star}a_{-}K_{-}+a_{+}a_{-}^{\star}J_{-}
\end{array}\right).
\end{equation}

\end_inset

Putting these results together, we have
\begin_inset Formula 
\begin{multline}
\mathsf{w}_{j}^{T}\mathsf{A}_{1}\mathsf{v}_{k}=\\
\omega_{\mathrm{t}}^{2}\Re\left[\Gamma_{\mathrm{t}}W\left(\begin{array}{cc}
\mathsf{X} & i\mathsf{X}\\
i\mathsf{X} & -\mathsf{X}
\end{array}\right)_{jk}-\Gamma_{\mathrm{t}}\left(\begin{array}{cc}
\mathsf{M} & i\mathsf{M}\\
i\mathsf{M} & -\mathsf{M}
\end{array}\right)_{jk}\right]\label{eq:A1 element final}
\end{multline}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
W\equiv\omega_{\mathrm{1}}H+G_{D}-\left|a_{+}\right|^{2}I_{+}-\left|a_{-}\right|^{2}I_{-},
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\mathsf{w}_{j}^{T}\mathsf{B}_{0}\mathsf{v}_{k}=-\omega_{\mathrm{t}}^{2}\Im\left[\Gamma_{\mathrm{t}}H\left(\begin{array}{cc}
\mathsf{X} & i\mathsf{X}\\
i\mathsf{X} & -\mathsf{X}
\end{array}\right)_{jk}\right].\label{eq:B0 element final}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Next, by straightforward computation, we obtain
\begin_inset Formula 
\begin{multline}
\mathsf{w}_{j}^{T}\mathsf{A}_{1/2}\mathsf{x}_{1/2}=\\
-\sum_{k}b_{k}\int d^{3}x\,\omega_{\mathrm{t}}^{2}D_{\mathrm{t}}\Re\left[\Gamma_{\mathrm{t}}\left(\vec{f}\cdot\vec{e}_{j}\right)\left(\vec{f}\cdot\vec{e}_{k}^{\star}+\vec{f}^{\star}\cdot\vec{e}_{k}\right)\right].\label{eq:A1/2 matrix element}
\end{multline}

\end_inset

Again, by straightforward computation, we see that
\begin_inset Formula 
\begin{align}
\int d^{3}x\,D_{\mathrm{t}}\left(\vec{f}\cdot\vec{e}_{j}\right)\left(\vec{f}\cdot\vec{e}_{k}^{\star}\right) & =\left(\begin{array}{cc}
\mathsf{Q} & -i\mathsf{Q}\\
i\mathsf{Q} & \mathsf{Q}
\end{array}\right)_{jk}\nonumber \\
\int d^{3}x\,D_{\mathrm{t}}\left(\vec{f}\cdot\vec{e}_{j}\right)\left(\vec{f}^{\star}\cdot\vec{e}_{k}\right) & =\left(\begin{array}{cc}
\mathsf{P} & i\mathsf{P}\\
i\mathsf{P} & -\mathsf{P}
\end{array}\right)_{jk}
\end{align}

\end_inset

where
\begin_inset Formula 
\begin{align}
\mathsf{Q} & \equiv\left(\begin{array}{cc}
a_{+}a_{-}(I_{+}+J_{+}) & a_{-}^{2}I_{-}+a_{+}^{2}K_{+}\\
a_{+}^{2}I_{+}+a_{-}^{2}K_{-} & a_{+}a_{-}(I_{-}+J_{-})
\end{array}\right)\nonumber \\
\mathsf{P} & \equiv\left(\begin{array}{cc}
a_{-}a_{+}^{\star}I_{+}+a_{+}a_{-}^{\star}K_{+} & \left|a_{-}\right|^{2}I_{-}+\left|a_{+}\right|^{2}J_{+}\\
\left|a_{+}\right|^{2}I_{+}+\left|a_{-}\right|^{2}J_{-} & a_{+}a_{-}^{\star}I_{-}+a_{-}a_{+}^{\star}K_{-}
\end{array}\right).
\end{align}

\end_inset

Putting this together, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:A1/2 matrix element"

\end_inset

 then becomes
\begin_inset Formula 
\begin{multline}
\mathsf{w}_{j}^{T}\mathsf{A}_{1/2}\mathsf{x}_{1/2}=\\
-\sum_{k}b_{k}\omega_{\mathrm{t}}^{2}\Re\left[\Gamma_{\mathrm{t}}\left(\begin{array}{cc}
\mathsf{Q}+\mathsf{P} & i(\mathsf{P}-\mathsf{Q})\\
i(\mathsf{P}+\mathsf{Q}) & \mathsf{Q}-\mathsf{P}
\end{array}\right)_{jk}\right].
\end{multline}

\end_inset

Combining this with Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:A1 element final"

\end_inset

 and Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:B0 element final"

\end_inset

, defining 
\begin_inset Formula $\tilde{\mathsf{P}}\equiv\mathsf{P}+\mathsf{M}-W\mathsf{X}$
\end_inset

, and evaluating the real and imaginary components, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:first order quadratic"

\end_inset

 becomes
\begin_inset Formula 
\begin{multline}
\left(\begin{array}{cc}
\Re\left[\Gamma_{\mathrm{t}}(\mathsf{Q}+\tilde{\mathsf{P}})\right] & \Im\left[\Gamma_{\mathrm{t}}(\mathsf{Q}-\tilde{\mathsf{P}})\right]\\
-\Im\left[\Gamma_{\mathrm{t}}(\mathsf{Q}+\tilde{\mathsf{P}})\right] & \Re\left[\Gamma_{\mathrm{t}}(\mathsf{Q}-\tilde{\mathsf{P}})\right]
\end{array}\right)\mathsf{b}\\
=-\sigma_{1}\left(\begin{array}{cc}
\Im(\Gamma_{\mathrm{t}}H)\mathsf{X} & \Re(\Gamma_{\mathrm{t}}H)\mathsf{X}\\
\Re(\Gamma_{\mathrm{t}}H)\mathsf{X} & -\Im(\Gamma_{\mathrm{t}}H)\mathsf{X}
\end{array}\right)\mathsf{b}.
\end{multline}

\end_inset

Using the fact that 
\begin_inset Formula $\mathsf{X}$
\end_inset

 is its own inverse, we multiply this equation by the matrix on the right-hand
 side, and obtain
\begin_inset Formula 
\begin{equation}
\left(\begin{array}{cc}
\Im\left[\mathsf{X}(\mathsf{Q}+\tilde{\mathsf{P}})/H\right] & -\Re\left[\mathsf{X}(\mathsf{Q}-\tilde{\mathsf{P}})/H\right]\\
-\Re\left[\mathsf{X}(\mathsf{Q}+\tilde{\mathsf{P}})/H\right] & -\Im\left[\mathsf{X}(\mathsf{Q}-\tilde{\mathsf{P}})/H\right]
\end{array}\right)\mathsf{b}=\sigma_{1}\mathsf{b},\label{eq:final linear eigenvalue problem}
\end{equation}

\end_inset

which is a 
\begin_inset Formula $4\times4$
\end_inset

 linear eigenvalue problem for 
\begin_inset Formula $\sigma_{1}$
\end_inset

.
\end_layout

\begin_layout Subsection
Closed-form stability eigenvalues
\end_layout

\begin_layout Standard
We now diagonalize Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:final linear eigenvalue problem"

\end_inset

 for each of the lasing mode solutions in Sec.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Threshold-perturbation-theory"

\end_inset

.
 
\end_layout

\begin_layout Subsubsection*
Circulating lasing mode
\end_layout

\begin_layout Standard
For the circulating solution in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:circulating lasing"

\end_inset

, we have 
\begin_inset Formula $a_{-}=0$
\end_inset

, leading to 
\begin_inset Formula $W=0$
\end_inset

 and 
\begin_inset Formula $\tilde{\mathsf{P}}=\mathsf{P}$
\end_inset

.
 The matrix in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:final linear eigenvalue problem"

\end_inset

 then becomes
\begin_inset Formula 
\begin{equation}
\left(\begin{array}{cccc}
2\Im\left(\frac{I_{+}}{H}\right) & 0 & 0 & 0\\
0 & \Im\left(\frac{K_{+}+J_{+}}{H}\right) & 0 & -\Re\left(\frac{K_{+}-J_{+}}{H}\right)\\
-2\Re\left(\frac{I_{+}}{H}\right) & 0 & 0 & 0\\
0 & -\Re\left(\frac{K_{+}+J_{+}}{H}\right) & 0 & -\Im\left(\frac{K_{+}-J_{+}}{H}\right)
\end{array}\right)|a_{+}|^{2},
\end{equation}

\end_inset

where 
\begin_inset Formula $|a_{+}|^{2}\equiv\frac{\omega_{1}H+G_{D}}{I_{+}}$
\end_inset

.
 By inspection, there is an eigenpair with
\begin_inset Formula 
\begin{equation}
\sigma_{1}=0,\;\mathsf{b}=\left(\begin{array}{c}
0\\
0\\
1\\
0
\end{array}\right).
\end{equation}

\end_inset

Since the third component of the basis is 
\begin_inset Formula $\mathbf{e}_{3}=i\mathbf{E}_{+}$
\end_inset

, this eigenvector corresponds to a global phase rotation 
\begin_inset Formula $\mathbf{E}_{+}\rightarrow(1+i\delta)\mathbf{E}_{+}$
\end_inset

, which is a continuous symmetry of the original Maxwell--Bloch equations.
 A second eigenpair is
\begin_inset Formula 
\begin{equation}
\sigma_{1}=2\left|a_{+}\right|^{2}\Im\left(\frac{I_{+}}{H}\right),\;\mathsf{b}=\left(\begin{array}{c}
\Im\left(\frac{I_{+}}{H}\right)\\
0\\
-\Re\left(\frac{I_{+}}{H}\right)\\
0
\end{array}\right).
\end{equation}

\end_inset

The remaining two eigenvalues are
\begin_inset Formula 
\begin{equation}
\sigma_{1}=\left[\Im\left(\frac{J_{+}}{H}\right)\pm\sqrt{\left|\frac{K_{+}}{H}\right|^{2}-\Re\left(\frac{J_{+}}{H}\right)^{2}}\right]\left|a_{+}\right|^{2},
\end{equation}

\end_inset

with
\begin_inset Formula 
\begin{equation}
\mathbf{b}=\left(\begin{array}{c}
0\\
\Re\left(\frac{K_{+}-J_{+}}{H}\right)\\
0\\
\Im\left(\frac{K_{+}}{H}\right)\mp\sqrt{\left|\frac{K_{+}}{H}\right|^{2}-\Re\left(\frac{J_{+}}{H}\right)^{2}}
\end{array}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection*
Standing-wave modes, 
\begin_inset Formula $n\neq4\ell$
\end_inset


\end_layout

\begin_layout Standard
We now diagonalize Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:final linear eigenvalue problem"

\end_inset

 for the standing-wave modes.
 First, for 
\begin_inset Formula $n\neq4\ell$
\end_inset

, standing-wave modes only occur in 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

, as discussed in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec: appendix allowed lasing modes"

\end_inset

.
 In this case, all 
\begin_inset Formula $K_{\pm}=0$
\end_inset

, and 
\begin_inset Formula $I_{+},J_{+}=I_{-},J_{-}$
\end_inset

.
 The matrix in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:final linear eigenvalue problem"

\end_inset

 then becomes 
\begin_inset Formula $2|a|^{2}\times$
\end_inset


\begin_inset Formula 
\begin{equation}
\left(\begin{array}{cccc}
\Im\left(\frac{I}{H}\right) & \Re(z)\Im\left(\frac{I+J}{H}\right) & 0 & \Im(z)\Im\left(\frac{I+J}{H}\right)\\
\Im\left[z\left(\frac{I+J}{H}\right)\right] & \Re(z)\Im\left(\frac{Iz}{H}\right) & 0 & \Im(z)\Im\left(\frac{Iz}{H}\right)\\
-\Re\left(\frac{I}{H}\right) & -\Re(z)\Re\left(\frac{I+J}{H}\right) & 0 & -\Im(z)\Re\left(\frac{I+J}{H}\right)\\
-\Re\left[z\left(\frac{I+J}{H}\right)\right] & -\Re(z)\Re\left(\frac{Iz}{H}\right) & 0 & -\Im(z)\Re\left(\frac{Iz}{H}\right)
\end{array}\right),
\end{equation}

\end_inset

where 
\begin_inset Formula $|a|^{2}=\frac{\omega_{1}H+G_{D}}{2I+J}$
\end_inset

.
 This matrix has 
\emph on
two
\emph default
 zero eigenvectors that have 
\begin_inset Formula $\sigma_{1}=0$
\end_inset

:
\begin_inset Formula 
\begin{equation}
\mathsf{b}=\left(\begin{array}{c}
0\\
0\\
1\\
0
\end{array}\right),\;\mathsf{b}=\left(\begin{array}{c}
0\\
\Im(z)\\
0\\
\Re(z)
\end{array}\right),
\end{equation}

\end_inset

which comes from the two continuous degrees of freedom in the solution:
 the overall global phase freedom, as well as the relative phase 
\begin_inset Formula $z$
\end_inset

 in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:n != 4 lasing"

\end_inset

.
 It is straightforward to find the other two eigenpairs, which are
\begin_inset Formula 
\begin{equation}
\sigma_{1}=2\Im\left(\frac{2I+J}{H}\right)|a|^{2},\;\mathsf{b}=\left(\begin{array}{c}
1\\
\Re(z)\\
0\\
\Im(z)
\end{array}\right),
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\sigma_{1}=-2\Im\left(\frac{J}{H}\right)|a|^{2},\;\mathsf{b}=\left(\begin{array}{c}
-1\\
\Re(z)\\
0\\
\Im(z)
\end{array}\right).
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection*
Standing-wave modes, 
\begin_inset Formula $n=4\ell$
\end_inset

 
\end_layout

\begin_layout Standard
Next, we examine the case 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 for 
\begin_inset Formula $n=4\ell$
\end_inset

 (standing-wave modes also exist here in the 
\begin_inset Formula $C_{n}$
\end_inset

 case, but Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:final linear eigenvalue problem"

\end_inset

 must be diagonalized numerically).
 For the case of a 
\begin_inset Formula $\mathbf{E}_{+}\pm\mathbf{E}_{-}$
\end_inset

 lasing mode (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:E+ + E- lasing"

\end_inset

), the matrix in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:final linear eigenvalue problem"

\end_inset

 is 
\begin_inset Formula $2|a|^{2}\times$
\end_inset

 
\begin_inset Formula 
\begin{equation}
\left(\begin{array}{cccc}
\Im\left(\frac{I}{H}\right) & \pm\Im\left(\frac{I+J+K}{H}\right) & -\Re\left(\frac{K}{H}\right) & \pm\Re\left(\frac{K}{H}\right)\\
\pm\Im\left(\frac{I+J+K}{H}\right) & \Im\left(\frac{I}{H}\right) & \pm\Re\left(\frac{K}{H}\right) & -\Re\left(\frac{K}{H}\right)\\
-\Re\left(\frac{I}{H}\right) & \mp\Re\left(\frac{I+J+K}{H}\right) & -\Im\left(\frac{K}{H}\right) & \pm\Im\left(\frac{K}{H}\right)\\
\mp\Re\left(\frac{I+J+K}{H}\right) & -\Re\left(\frac{I}{H}\right) & \pm\Im\left(\frac{K}{H}\right) & -\Im\left(\frac{K}{H}\right)
\end{array}\right),
\end{equation}

\end_inset

where 
\begin_inset Formula $|a|^{2}=\frac{\omega_{1}H+G_{D}}{2I+J+K}$
\end_inset

, and the 
\begin_inset Formula $\pm$
\end_inset

 symbols correspond to 
\begin_inset Formula $z=\pm1$
\end_inset

.
 There is a single zero eigenvalue:
\begin_inset Formula 
\begin{equation}
\sigma_{1}=0,\;\mathsf{b}=\left(\begin{array}{c}
0\\
0\\
1\\
\pm1
\end{array}\right).
\end{equation}

\end_inset

A second eigenpair is
\begin_inset Formula 
\begin{equation}
\sigma_{1}=2|a|^{2}\Im\left(\frac{2I+J+K}{H}\right),\;\mathsf{b}=\left(\begin{array}{c}
1\\
\pm1\\
0\\
0
\end{array}\right).
\end{equation}

\end_inset

Empirically, we have found that this eigenvalue is always stable.
 The final two eigenvalues are
\begin_inset Formula 
\begin{multline}
\sigma_{1}=-|a|^{2}\Im\left(\frac{J+3K}{H}\right)\pm\\
|a|^{2}\sqrt{\Im\left(\frac{J-K}{H}\right)^{2}-8\Re\left(\frac{K}{H}\right)\Re\left(\frac{J+K}{H}\right)}\label{eq:z = 1 double eigenvalues}
\end{multline}

\end_inset

(the eigenvectors can be written down in closed form, but are tedious and
 not illuminating).
 Empirically, we have found that at least one of these two eigenvalues are
 unstable (except for an isolated case, that we explain below).
 Next, for the case of a 
\begin_inset Formula $\mathbf{E}_{+}\pm i\mathbf{E}_{-}$
\end_inset

 lasing mode (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:E+ + i E- lasing"

\end_inset

, the matrix in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:final linear eigenvalue problem"

\end_inset

 is 
\begin_inset Formula $2|a|^{2}\times$
\end_inset


\begin_inset Formula 
\begin{equation}
\left(\begin{array}{cccc}
\Im\left(\frac{I}{H}\right) & \pm\Re\left(\frac{K}{H}\right) & \Re\left(\frac{K}{H}\right) & \pm\Im\left(\frac{I+J-K}{H}\right)\\
\pm\Re\left(\frac{I+J-K}{H}\right) & \Im\left(\frac{K}{H}\right) & \pm\Im\left(\frac{K}{H}\right) & \Re\left(\frac{I}{H}\right)\\
-\Re\left(\frac{I}{H}\right) & \pm\Im\left(\frac{K}{H}\right) & \Im\left(\frac{K}{H}\right) & \mp\Re\left(\frac{I+J-K}{H}\right)\\
\pm\Im\left(\frac{I+J-K}{H}\right) & -\Re\left(\frac{K}{H}\right) & \mp\Re\left(\frac{K}{H}\right) & \Im\left(\frac{I}{H}\right)
\end{array}\right),
\end{equation}

\end_inset

where 
\begin_inset Formula $|a|^{2}=\frac{\omega_{1}H+G_{D}}{2I+J-K}$
\end_inset

, and the 
\begin_inset Formula $\pm$
\end_inset

 signs correspond to 
\begin_inset Formula $z=\pm i$
\end_inset

.
 There is an eigenpair with zero eigenvalue:
\begin_inset Formula 
\begin{equation}
\sigma_{1}=0,\;\mathsf{b}=\left(\begin{array}{c}
0\\
1\\
\mp1\\
0
\end{array}\right)
\end{equation}

\end_inset

and another eigenpair
\begin_inset Formula 
\begin{equation}
\sigma_{1}=2|a|^{2}\Im\left(\frac{2I+J-K}{H}\right),\;\mathsf{b}=\left(\begin{array}{c}
\pm1\\
0\\
0\\
1
\end{array}\right).
\end{equation}

\end_inset

Empirically, we have found that this eigenvalue is always stable.
 Finally, the remaining two eigenvalues are
\begin_inset Formula 
\begin{multline}
\sigma_{1}=|a|^{2}\Im\left(\frac{3K-J}{H}\right)\pm\\
|a|^{2}\sqrt{\Im\left(\frac{J+K}{H}\right)^{2}+8\Re\left(\frac{K}{H}\right)\Re\left(\frac{J-K}{H}\right)}\label{eq:z = i double eigenvalues}
\end{multline}

\end_inset

(the eigenvectors can be written down in closed form, but are tedious and
 not illuminating).
 Empirically, we have found that at least one of these two eigenvalues are
 unstable, except for an isolated case that we will now explain.
\end_layout

\begin_layout Standard
We note that for the previous two cases, where 
\begin_inset Formula $n=4\ell$
\end_inset

, it is possible to choose the shape of the gain profile 
\begin_inset Formula $D_{\mathrm{t}}(\mathbf{x})$
\end_inset

 such that 
\begin_inset Formula $J=\pm K$
\end_inset

, in which case the 
\emph on
one 
\emph default
of the two pairs 
\begin_inset Formula $\mathbf{E}_{+}\pm\mathbf{E}_{-}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{+}\pm i\mathbf{E}_{-}$
\end_inset

 actually becomes 
\emph on
stable
\emph default
.
 To see this, we consider a 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 geometry with 
\begin_inset Formula $n=4\ell$
\end_inset

.
 Equation.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:chiral definition"

\end_inset

 then becomes
\begin_inset Formula 
\begin{equation}
\mathbf{E}_{\pm}=\sum_{b=1}^{n}(\pm i)^{b}R_{b/n}\mathbf{E}_{\mathrm{even}}.
\end{equation}

\end_inset

The specific choice of geometry requires that we place radially-symmetric
 lines of gain on the faces or diagonals of the 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 geometry, which preserves the 
\begin_inset Formula $C_{n\mathrm{v}}$
\end_inset

 symmetry.
 We can write this as
\begin_inset Formula 
\begin{equation}
D_{\mathrm{t}}(\mathbf{x})=\sum_{a=1}^{n}G(r)\delta\left(\theta-\theta_{a}\right),
\end{equation}

\end_inset

where 
\begin_inset Formula $\theta_{a}=\frac{2\pi a}{n}$
\end_inset

 for the faces, and 
\begin_inset Formula $\theta_{a}=(2a+1)\frac{\pi}{n}$
\end_inset

 for the diagonals.
 For a TM geometry, we then have the overlap integrals (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:I J K definitions"

\end_inset

)
\begin_inset Formula 
\begin{align}
J & =\sum_{a=1}^{n}\int rdr\,G(r)\left|E_{+}\left(r,\theta_{a}\right)\right|^{2}E_{-}(r,\theta_{a})E_{+}(r,\theta_{a})\nonumber \\
K & =\sum_{a=1}^{n}\int rdr\,G(r)E_{+}(r,\theta_{a})^{\star}E_{-}(r,\theta_{a})^{3}.
\end{align}

\end_inset

It can be shown that depending on the choice of 
\begin_inset Formula $\theta_{a}$
\end_inset

 being the faces or diagonals, we will have either 
\begin_inset Formula $K=J$
\end_inset

 or 
\begin_inset Formula $K=-J$
\end_inset

.
 For 
\begin_inset Formula $K=J$
\end_inset

, the eigenvalues in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:z = i double eigenvalues"

\end_inset

; of the 
\begin_inset Formula $\mathbf{E}_{+}\pm i\mathbf{E}_{-}$
\end_inset

 standing-wave modes, become 0 and a stable eigenvalue.
 For 
\begin_inset Formula $K=-J$
\end_inset

, the same happens for those in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:z = 1 double eigenvalues"

\end_inset

; of the 
\begin_inset Formula $\mathbf{E}_{+}\pm\mathbf{E}_{-}$
\end_inset

 standing-wave modes.
 
\end_layout

\begin_layout Subsection
Region of validity in small-
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

 limit
\begin_inset CommandInset label
LatexCommand label
name "sub:Region-of-validity"

\end_inset


\end_layout

\begin_layout Standard
In this section, we work out the 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

 dependence of higher-order terms in the perturbation theory, and demonstrate
 that the regime of validity of the perturbation theory depends on 
\begin_inset Formula $d$
\end_inset

 being small compared to a constant multiple of 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

.
 We show that the exact expansion of 
\begin_inset Formula $\sigma/d$
\end_inset

 to all orders in 
\begin_inset Formula $d$
\end_inset

 only contains terms of the form 
\begin_inset Formula $d^{\ell}/\gamma_{\parallel}^{j}$
\end_inset

 with 
\begin_inset Formula $\ell\geq j$
\end_inset

, and that in the limit where 
\begin_inset Formula $\gamma_{\parallel},d\to0$
\end_inset

, with 
\begin_inset Formula $d$
\end_inset

 vanishing at least as rapidly as 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

, the terms with 
\begin_inset Formula $\ell>j$
\end_inset

 vanish and the stability eigenvalue takes the asymptotic functional form
 
\begin_inset Formula $\sigma/d=f(d/\gamma_{\parallel})$
\end_inset

.
 Here, 
\begin_inset Formula $f(0)$
\end_inset

 is exactly the first-order stability eigenvalue 
\begin_inset Formula $\sigma_{1}$
\end_inset

.
 For circulating modes that have 
\begin_inset Formula $\mathrm{Re}(\sigma_{1})<0$
\end_inset

, the the smallest positive solution 
\begin_inset Formula $z_{0}$
\end_inset

 of the equation 
\begin_inset Formula $\Re[f(z)]=0$
\end_inset

 gives a boundary of stability, for which a circulating lasing mode becomes
 
\emph on
unstable 
\emph default
for 
\begin_inset Formula $d>\gamma_{\parallel}z_{0}$
\end_inset

, as seen in the ring-laser example in Ref.
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "ref-rotter_degeneracy"

\end_inset

.
\end_layout

\begin_layout Standard
First, since we have already obtained closed-form expressions for 
\begin_inset Formula $\sigma_{1}$
\end_inset

 and the coefficients 
\begin_inset Formula $b_{k}$
\end_inset

 of 
\begin_inset Formula $\mathsf{x}_{0}$
\end_inset

, Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:first order quadratic"

\end_inset

 can be solved for 
\begin_inset Formula $\mathsf{x}_{1}$
\end_inset

: 
\begin_inset Formula $\mathsf{x}_{1}=\mathsf{A}_{0}^{-1}\left[\left(\mathsf{B}_{0}\sigma_{1}+\mathsf{A}_{1}\right)\mathsf{x}_{0}+\mathsf{A}_{1/2}\mathsf{x}_{1/2}\right]$
\end_inset

.
 Next, at order 
\begin_inset Formula $d^{3/2}$
\end_inset

, we have
\begin_inset Formula 
\begin{multline}
\mathsf{A}{}_{3/2}\mathsf{x}{}_{0}+\mathsf{A}{}_{1}\mathsf{x}{}_{1/2}+\mathsf{A}{}_{1/2}\mathsf{x}{}_{1}+\mathsf{A}{}_{0}\mathsf{x}{}_{3/2}\\
=-\mathsf{B}_{0}\sigma_{3/2}\mathsf{x}{}_{0}-\mathsf{B}_{0}\sigma_{1}\mathsf{x}{}_{1/2}.
\end{multline}

\end_inset

The first three terms on the left-hand side as well as the very last term
 on the right all have the same nonzero pattern as 
\begin_inset Formula $\mathsf{x}_{1/2}$
\end_inset

.
 Hence, multiplying both sides by 
\begin_inset Formula $\mathsf{x}_{0}^{T}$
\end_inset

 (which is now known after having solved the degenerate problem at order
 
\begin_inset Formula $d$
\end_inset

), we obtain 
\begin_inset Formula $0=\sigma_{3/2}\mathsf{x}_{0}^{T}\mathsf{B}_{0}\mathsf{x}{}_{0}$
\end_inset

, which leads to 
\begin_inset Formula $\sigma_{3/2}=0$
\end_inset

.
 The only remaining unknown is then 
\begin_inset Formula $\mathsf{x}_{3/2}$
\end_inset

.
 By the same arguments leading to Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:x1/2 exact"

\end_inset

, we have 
\begin_inset Formula $\mathsf{A}{}_{0}\mathsf{x}{}_{3/2}=\gamma_{\parallel}\mathsf{x}{}_{3/2}$
\end_inset

, which yields 
\begin_inset Formula $\mathsf{x}_{3/2}=-\gamma_{\parallel}^{-1}\mathsf{f}_{3/2}$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\mathsf{f}_{3/2}\equiv\mathsf{A}{}_{3/2}\mathsf{x}{}_{0}+\mathsf{A}{}_{1}\mathsf{x}{}_{1/2}+\mathsf{A}{}_{1/2}\mathsf{x}{}_{1}+\mathsf{B}_{0}\sigma_{1}\mathsf{x}{}_{1/2},
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathsf{f}_{3/2}$
\end_inset

 is 
\begin_inset Formula $\mathcal{O}(1)$
\end_inset

 with respect to 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

, i.e.
 it goes to a constant as 
\begin_inset Formula $\gamma_{\parallel}\rightarrow0$
\end_inset

.
 Moving onto order 
\begin_inset Formula $d^{2}$
\end_inset

, we have
\begin_inset Formula 
\begin{multline}
\mathsf{C}\sigma_{1}^{2}\mathsf{x}_{0}+\mathsf{B}_{0}\left(\sigma_{2}\mathsf{x}{}_{0}+\sigma_{1}\mathsf{x}{}_{1}\right)+\mathsf{B}_{1}\sigma_{1}\mathsf{x}_{0}\\
=-\sum_{k=0}^{4}\mathsf{A}_{k/2}\mathsf{x}_{2-\frac{k}{2}}.
\end{multline}

\end_inset

Multiplying both sides by 
\begin_inset Formula $\mathsf{x}_{0}^{T}$
\end_inset

 annihilates the 
\begin_inset Formula $k=0$
\end_inset

 term, leaving only a single unknown 
\begin_inset Formula $\sigma_{2}$
\end_inset

 and a single term of 
\begin_inset Formula $\mathcal{O}(\gamma_{\parallel}^{-1})$
\end_inset

: 
\begin_inset Formula $-\mathsf{A}_{1/2}\mathsf{x}_{3/2}=\gamma_{\parallel}^{-1}\mathsf{A}_{1/2}\mathsf{f}_{3/2}$
\end_inset

.
 We then have
\begin_inset Formula 
\begin{equation}
\gamma_{\parallel}\sigma_{2}=\frac{\mathsf{x}_{0}^{T}\mathsf{A}_{1/2}\mathsf{f}_{3/2}}{\mathsf{x}_{0}^{T}\mathsf{B}_{0}\mathsf{x}_{0}}+\mathcal{O}(\gamma_{\parallel}).
\end{equation}

\end_inset

Carrying on to the next order results in 
\begin_inset Formula $\sigma_{5/2}=0$
\end_inset

 and 
\begin_inset Formula $\mathsf{x}_{5/2}=-\gamma_{\parallel}^{-1}\mathsf{f}_{5/2}$
\end_inset

, where now 
\begin_inset Formula $\mathsf{f}_{5/2}=\mathcal{O}(\gamma_{\parallel}^{-1})$
\end_inset

 due to it including terms with 
\begin_inset Formula $\sigma_{2}$
\end_inset

 and 
\begin_inset Formula $\mathsf{x}_{2}$
\end_inset

.
 By continuing this process, we find that 
\begin_inset Formula $\sigma_{m+\frac{1}{2}}=0$
\end_inset

, and 
\begin_inset Formula $\mathsf{x}_{m+\frac{1}{2}}$
\end_inset

, 
\begin_inset Formula $\sigma_{m+1}$
\end_inset

, and 
\begin_inset Formula $\mathsf{x}_{m+1}$
\end_inset

 are all 
\begin_inset Formula $\mathcal{O}(\gamma_{\parallel}^{-m})$
\end_inset

.
 This is made possible by the fact that the only place 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

 occurs in the entire problem is the very last matrix element of 
\begin_inset Formula $\mathsf{A}_{0}$
\end_inset

 in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:A matrix"

\end_inset

, as well as the fact that the 
\begin_inset Formula $\mathsf{x}_{m+\frac{1}{2}}$
\end_inset

 and 
\begin_inset Formula $\mathsf{x}_{m}$
\end_inset

 have predictable nonzero patterns, due to the nonzero patterns of 
\begin_inset Formula $\mathsf{A}_{m+\frac{1}{2}}$
\end_inset

 being different from those of all the other matrices.
 Defining 
\begin_inset Formula $s_{m+1}\equiv\gamma_{\parallel}^{m}\sigma_{m+1}=\mathcal{O}(1)$
\end_inset

, we obtain a full expansion for the exact Maxwell--Bloch eigenvalue (Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:eigenpair expansion"

\end_inset

):
\begin_inset Formula 
\begin{equation}
\sigma\approx d\sum_{k=1}^{\infty}\left(\frac{d}{\gamma_{\parallel}}\right)^{k-1}s_{k},\label{eq:s expansion}
\end{equation}

\end_inset

where the 
\begin_inset Formula $\approx$
\end_inset

 comes from the fact that we have thrown away terms of the form 
\begin_inset Formula $d^{\ell}/\gamma_{\parallel}^{j}$
\end_inset

 with 
\begin_inset Formula $\ell>j$
\end_inset

, which are negligible compared to 
\begin_inset Formula $(d/\gamma_{\parallel})^{k}$
\end_inset

 and vanish in the limit 
\begin_inset Formula $d,\gamma_{\parallel}\rightarrow0$
\end_inset

 (provided that 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

 does not go zero more rapidly than 
\begin_inset Formula $d$
\end_inset

).
 In this limit, we can then infer a generic functional form of 
\begin_inset Formula $\sigma$
\end_inset

:
\begin_inset Formula 
\begin{equation}
\lim_{\gamma_{\parallel},d\rightarrow0}\frac{\sigma}{d}=f\left(\frac{d}{\gamma_{\parallel}}\right),\label{eq:limit gamma parallel}
\end{equation}

\end_inset

where 
\begin_inset Formula $f$
\end_inset

 is a complex-valued function (with a real argument) whose Taylor expansion
 is the sum in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:s expansion"

\end_inset

.
 For an eigenvalue 
\begin_inset Formula $\sigma$
\end_inset

 of the Maxwell--Bloch equation linearized about a circulating mode, we
 have 
\begin_inset Formula $f(0)=\sigma_{1}$
\end_inset

 having a negative real part.
 The smallest positive zero 
\begin_inset Formula $z_{0}$
\end_inset

 of 
\begin_inset Formula $\Re f$
\end_inset

 then gives the equation for a boundary of stability 
\begin_inset Formula $d=\gamma_{\parallel}z_{0}$
\end_inset

.
 Hence, in the limit that both 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

 and 
\begin_inset Formula $d$
\end_inset

 go to zero, the region of stability for a circulating mode is given by
 
\begin_inset Formula $d<\gamma_{\parallel}z_{0}$
\end_inset

, where 
\begin_inset Formula $z_{0}$
\end_inset

 is a constant independent of 
\begin_inset Formula $\gamma_{\parallel}$
\end_inset

 and 
\begin_inset Formula $d$
\end_inset

.
 
\end_layout

\begin_layout Section
Determining the dielectric perturbation 
\begin_inset Formula $\delta\varepsilon$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:Determining-the-dielectric-perturbation"

\end_inset


\end_layout

\begin_layout Standard
In this Appendix, we describe the processed used to force a degeneracy in
 a geometry whose symmetry has been broken by the discretization scheme
 (e.g.
 a 
\begin_inset Formula $C_{6\mathrm{v}}$
\end_inset

 geometry discretized into a rectangular grid).
 We first analyze the effect of a small 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 on the eigenfrequencies (of the lasing mode and the passive pole) by well-known
 first-order perturbation theory for Maxwell's equations 
\begin_inset CommandInset citation
LatexCommand cite
key "phc_book"

\end_inset

 (some modification is required to handle the nonlinearity of the hole-burning
 term above threshold).
 However, we first force the degeneracy below threshold (repeating as needed
 as the pump strength is increased), so that both passive poles reach threshold
 simultaneously.
 (In practice, we achieved the fastest convergence by allowing passive poles
 to have positive imaginary parts, and then setting the pump strength so
 that the two poles 
\begin_inset Quotes eld
\end_inset

straddle
\begin_inset Quotes erd
\end_inset

 the real axis; this way, when they meet in the middle they are both exactly
 at threshold.) Below threshold, the eigenproblem is linear in the eigenvector
 
\begin_inset Formula $\mathbf{E}$
\end_inset

 (the nonlinearity in 
\begin_inset Formula $\omega$
\end_inset

 is still present but easy to deal with using standard methods), and we
 can apply standard perturbation theory (albeit for a complex-symmetric
 operator, not a Hermitian operator) as follows:
\end_layout

\begin_layout Standard
Consider two nonlasing modes that satisfy
\begin_inset Formula 
\begin{align}
0 & =-\nabla\times\nabla\times\mathbf{E}_{\mu}+\omega_{\mu}^{2}\varepsilon_{\mu}\mathbf{E}_{\mu}\nonumber \\
\varepsilon_{\mu} & \equiv\varepsilon_{c}+\Dt\Gamma(\omega_{\mu})
\end{align}

\end_inset

Adding a perturbation to the dielectric 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 will result in corresponding responses 
\begin_inset Formula $\delta\mathbf{E}_{\mu}$
\end_inset

 and 
\begin_inset Formula $\delta\omega_{\mu}$
\end_inset

.
 As in the threshold perturbation theory, we multiply both sides by 
\begin_inset Formula $\mathbf{E}_{\mu}$
\end_inset

 and keep only first-order terms.
 Terms involving 
\begin_inset Formula $\delta\mathbf{E}_{\mu}$
\end_inset

 again vanish because the operators act to the left, and we are left with
 
\begin_inset CommandInset citation
LatexCommand cite
key "ref-raman,ref-microcavity,ref-adi"

\end_inset


\begin_inset Formula 
\begin{equation}
\delta\omega_{\mu}=-\frac{\int d^{3}x\,\mathbf{E}_{\mu}\cdot\delta\varepsilon\mathbf{E}_{\mu}}{\int d^{3}x\,\mathbf{E}_{\mu}\cdot\left(\frac{2\varepsilon_{\mu}}{\omega_{\mu}}+\frac{\partial\varepsilon_{\mu}}{\partial\omega_{\mu}}\right)\mathbf{E}_{\mu}}.\label{eq:delta_omega_QP}
\end{equation}

\end_inset

We write this frequency shift as an inner product 
\begin_inset Formula 
\begin{equation}
\delta\omega_{\mu}=-p_{\mu}^{T}\delta\varepsilon.\label{eq:delta_omega_mu}
\end{equation}

\end_inset

As an aside, while it is fine to use a scalar 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 function for this procedure, in the case when the 
\begin_inset Formula $\mathbf{E}_{\mu}$
\end_inset

 are TE modes or fully-vectorial fields, then it is also possible to allow
 
\begin_inset Formula $\delta\varepsilon(\mathbf{x})$
\end_inset

 to be a diagonally anisotropic tensor
\begin_inset Formula 
\begin{equation}
\overleftrightarrow{\delta\varepsilon}(\mathbf{x})=\left(\begin{array}{ccc}
\delta\varepsilon_{xx}(\mathbf{x}) & 0 & 0\\
0 & \delta\varepsilon_{yy}(\mathbf{x}) & 0\\
0 & 0 & \delta\varepsilon_{zz}(\mathbf{x})
\end{array}\right).\label{eq:tensor_delta_epsilon}
\end{equation}

\end_inset

The column-vector form of 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 in Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:delta_omega_mu"

\end_inset

 would then have as its elements all the real and imaginary components of
 
\begin_inset Formula $\overleftrightarrow{\delta\varepsilon}(\mathbf{x})$
\end_inset

 at each Yee point 
\begin_inset CommandInset citation
LatexCommand cite
key "taflove"

\end_inset

 [
\begin_inset Formula $\delta\varepsilon_{xx}(\mathbf{x})$
\end_inset

, 
\begin_inset Formula $\delta\varepsilon_{yy}(\mathbf{x})$
\end_inset

, and 
\begin_inset Formula $\delta\varepsilon_{zz}(\mathbf{x})$
\end_inset

 for all the grid points 
\begin_inset Formula $\mathbf{x}$
\end_inset

], while the row-vector 
\begin_inset Formula $p_{\mu}^{T}$
\end_inset

 would have as its elements the real and imaginary parts of 
\begin_inset Formula $E_{x}(\mathbf{x})^{2}$
\end_inset

, 
\begin_inset Formula $E_{y}(\mathbf{x})^{2}$
\end_inset

, and 
\begin_inset Formula $E_{z}(\mathbf{x})^{2}$
\end_inset

 at all the grid points.
 If we take this option, then the norm we minimize would be
\begin_inset Formula 
\begin{equation}
\left\Vert \delta\varepsilon\right\Vert _{2}^{2}=\int d^{3}x\,\left\Vert \overleftrightarrow{\delta\varepsilon}(\mathbf{x})\right\Vert _{F}^{2},
\end{equation}

\end_inset

where the Frobenius norm 
\begin_inset CommandInset citation
LatexCommand cite
key "trefethen"

\end_inset

 at each point 
\begin_inset Formula $\mathbf{x}$
\end_inset

 is defined as
\begin_inset Formula 
\begin{equation}
\left\Vert \overleftrightarrow{\delta\varepsilon}(\mathbf{x})\right\Vert _{F}^{2}\equiv\left|\delta\varepsilon_{xx}(\mathbf{x})\right|^{2}+\left|\delta\varepsilon_{yy}(\mathbf{x})\right|^{2}+\left|\delta\varepsilon_{zz}(\mathbf{x})\right|^{2}.
\end{equation}

\end_inset

Whether we take 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 to be a scalar or a tensor, the degeneracy-forcing condition 
\begin_inset Formula $\omega_{1}+\delta\omega_{1}=\omega_{2}+\delta\omega_{2}$
\end_inset

 then becomes
\begin_inset Formula 
\begin{equation}
(p_{2}-p_{1})^{T}\delta\varepsilon=\omega_{2}-\omega_{1}.\label{eq:degeneracy_forcing}
\end{equation}

\end_inset

It turns out that the solution of a quadratic program with equality constraints
 can be obtained directly by solving a linear 
\emph on
dual
\emph default
 problem 
\begin_inset CommandInset citation
LatexCommand cite
key "boyd"

\end_inset

, which in this case is
\begin_inset Formula 
\begin{equation}
\left(\begin{array}{cccc}
1 & 0 & q^{R} & q^{I}\\
0 & 1 & -q^{I} & q^{R}\\
\left(q^{R}\right)^{T} & -\left(q^{I}\right)^{T} & 0 & 0\\
\left(q^{I}\right)^{T} & \left(q^{R}\right)^{T} & 0 & 0
\end{array}\right)\left(\begin{array}{c}
\delta\varepsilon^{R}\\
\delta\varepsilon^{I}\\
\lambda_{1}\\
\lambda_{2}
\end{array}\right)=\left(\begin{array}{c}
0\\
0\\
\omega_{2}^{R}-\omega_{1}^{R}\\
\omega_{2}^{I}-\omega_{1}^{I}
\end{array}\right).
\end{equation}

\end_inset

Here, the superscripts 
\begin_inset Formula $^{R}$
\end_inset

 and 
\begin_inset Formula $^{I}$
\end_inset

 denote real and imaginary parts, and we have defined 
\begin_inset Formula $q\equiv p_{2}-p_{1}$
\end_inset

, and the 
\begin_inset Formula $\lambda_{1,2}$
\end_inset

 are Lagrange multipliers that are not needed.
 When 
\begin_inset Formula $\omega_{2}$
\end_inset

 is very close to 
\begin_inset Formula $\omega_{1}$
\end_inset

, we can improve the condition number of the matrix by freely multiplying
 the second-to-last row and column of the matrix by a constant factor, provided
 that the second-to-last element of the right-hand side is 
\emph on
divided 
\emph default
by the same factor.
 The same can be done for the last row and column, with the last element
 of the right-hand side.
 
\end_layout

\begin_layout Standard
Note that even after the thresholds and threshold frequencies have been
 made exactly degenerate using the QP procedure illustrated above, we are
 still in principle forcing the degeneracy.
 Above threshold, the delicate balance created by 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 to force the frequencies together is slightly broken.
 This results in an 
\emph on
approximate 
\emph default
degeneracy that is maintained very far above threshold, as shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:QP_stability"

\end_inset

, with only a 
\begin_inset Formula $10^{-8}$
\end_inset

 splitting for pump strengths up to 100 times threshold.
 In practice, these results are already accurate enough to give all the
 desired physical information about the degenerate pair.
 If we wanted to be absolutely correct and force the degeneracy to machine
 precision (as it was in the exactly symmetric case for odd-
\begin_inset Formula $\ell$
\end_inset

 modes), we could simply perform QP again at some given 
\begin_inset Formula $d>0$
\end_inset

 to force 
\begin_inset Formula $\delta\omega$
\end_inset

 and 
\begin_inset Formula $\delta\omega^{\prime}$
\end_inset

 back together.
 One extra caveat in this case is that 
\begin_inset Formula $\delta\omega$
\end_inset

 is now a lasing pole, so the spatial hole-burning term need to be taken
 account for the perturbation theory (
\begin_inset Formula $\delta\omega^{\prime}$
\end_inset

 is still a passive pole, so the previous perturbation theory still applies),
 and instead of Eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "eq:delta_omega_QP"

\end_inset

 we now have
\begin_inset Formula 
\begin{align}
\delta\omega & =-\frac{\int d^{3}x\,\mathbf{E}\cdot\left(\delta\varepsilon+\Dt\Gamma(\omega_{\mu})\delta H\right)\mathbf{E}}{\int d^{3}x\,\mathbf{E}\cdot\left(\frac{2\varepsilon}{\omega}+\frac{\partial\varepsilon}{\partial\omega}\right)\mathbf{E}}\nonumber \\
\varepsilon & \equiv\varepsilon_{c}+\Dt\Gamma(\omega)H\\
\delta H & \equiv\frac{1}{1+\left|\mathbf{E}+\delta\mathbf{E}\right|^{2}}-\frac{1}{1+\left|\mathbf{E}\right|^{2}}.\nonumber 
\end{align}

\end_inset

Here, 
\begin_inset Formula $\delta H$
\end_inset

 is the change in the spatial-hole burning term arising from the dielectric
 perturbation 
\begin_inset Formula $\delta\varepsilon$
\end_inset

.
 However, since there is no easy way to determine 
\begin_inset Formula $\delta\mathbf{E}$
\end_inset

 without numerically solving the full problem, 
\begin_inset Formula $\delta H$
\end_inset

 is hard to determine semi-analytically.
 A simple work-around is to set 
\begin_inset Formula $\delta H=0$
\end_inset

 above, which makes this procedure no longer a true first-order perturbation
 theory.
 However, since the splitting is already so small as shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:QP_stability"

\end_inset

, the 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 needed is also extremely small, so 
\begin_inset Formula $\delta H$
\end_inset

 is also negligible.
 Although 
\begin_inset Formula $\delta\omega$
\end_inset

 is not zero to first order, the 
\begin_inset Formula $\delta H=0$
\end_inset

 approximation is enough to find a 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 that greatly decreases 
\begin_inset Formula $\delta\omega$
\end_inset

.
 We find empirically that it usually takes one iteration of this above-threshold
 QP procedure to restore the degeneracy of the lasing pole 
\begin_inset Formula $\omega$
\end_inset

 and its passive mode 
\begin_inset Formula $\omega^{\prime}$
\end_inset

 to machine precision, since 
\begin_inset Formula $\delta\omega$
\end_inset

 is already very small.
 Practically speaking, this entire extra step is rarely needed since the
 solutions obtained from 
\begin_inset Formula $\delta\varepsilon$
\end_inset

 for the linear problem below threshold are already close enough for most
 pump strengths of physical interest.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "references"
options "apsrev4-1"

\end_inset


\end_layout

\end_body
\end_document
